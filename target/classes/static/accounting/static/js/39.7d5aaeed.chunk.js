(this["webpackJsonpportal-react"]=this["webpackJsonpportal-react"]||[]).push([[39],{1520:function(e,t,a){"use strict";a.r(t);var l=a(0),s=a.n(l),n=a(2),i=a(19),o=a(5),r=a(61),d=a(20),c=a.n(d),h=a(264);class m extends l.Component{constructor(e){super(e),this.onExpand=e=>{this.setState({expandedKeys:e})},this.onCheck=(e,t)=>{let a=[];t.checkedNodes.map(e=>{null!=e.props.grant&&a.push(e.props.grant),e.props.children.map(e=>{null!=e.props.grant&&a.push(e.props.grant)})}),this.setState({selectedChecks:e,selectedGrands:a})},this.state={defaultExpandedKeys:[],defaultSelectedKeys:[],defaultCheckedKeys:[],selectedGrands:[],selectedChecks:[],expandedKeys:[],disabledTree:!0},this.treeRef=s.a.createRef()}setCheckedBoxes(e){let t=[],a=this.props.treeData;a.map(a=>{e.map(e=>{null!=a.grant&&a.grant.id===e.id&&t.push(a.key)})}),a.map(a=>{a.children.map(a=>{null!=a.grant&&e.map(e=>{a.grant.id===e.id&&t.push(a.key)})})}),a.map(a=>{a.children.map(a=>{a.children.map(a=>{e.map(e=>{a.grant.id===e.id&&t.push(a.key)})})})}),a.map(a=>{a.children.map(a=>{a.children.map(a=>{a.children.map(a=>{e.map(e=>{a.grant.id===e.id&&t.push(a.key)})})})})}),this.setState({selectedChecks:t})}getAllKeys(e,t){return e.map(e=>{t.push(e.key),void 0!=e.children&&this.getAllKeys(e.children,t)}),t}expandTree(){let e=this.getAllKeys(this.props.treeData,[]);this.setState({expandedKeys:e})}collapseTree(){this.setState({expandedKeys:[]})}render(){return s.a.createElement("div",{style:{margin:"0 20px"}},s.a.createElement(h.a,{className:"myCls",showLine:!0,checkable:!0,selectable:!1,onExpand:this.onExpand,expandedKeys:this.state.expandedKeys,checkedKeys:this.state.selectedChecks,defaultSelectedKeys:this.state.defaultSelectedKeys,defaultCheckedKeys:this.state.defaultCheckedKeys,onCheck:this.onCheck,treeData:this.props.treeData,disabled:this.state.disabledTree}))}}var p=m,u=a(38),g=a.n(u),y=a(13),R=a.n(y),f=a(3),S=a(63),b=a(6),C=a.n(b),k=a(52),x=a(4),v=a(21),B=a(62),E=a.n(B);class D extends l.Component{constructor(e){super(e),this.arrangeDataSet=e=>{let t={};return t.sheetName=e.roleName+"_Rol\xfcne_Atananlar\u0131n_Listesi",t.uuid=Object(f.h)(),t.type="excel",t},this.state={content:[],loading:!1,total:0,page:0,manual:!1,size:10,searchQuery:void 0,searching:!1,selectedRole:void 0,selectedRowNum:-1,displayCreateRoleDialog:!1,displayUpdateRoleDialog:!1,displayGrantSelectionDialog:!1,disabledRoleDeleteBtn:!1,newRole:{id:null,defaultPersonalRole:!1,roleName:""},grants:[],grantsLoading:!1,approveAlert:null},this.fetchData=this.fetchData.bind(this),this.handleSearch=this.handleSearch.bind(this),this.onClickRole=this.onClickRole.bind(this),this.saveRoleClicked=this.saveRoleClicked.bind(this),this.updateRoleClicked=this.updateRoleClicked.bind(this),this.editClicked=this.editClicked.bind(this),this.editHandleInputChange=this.editHandleInputChange.bind(this),this.deleteRole=this.deleteRole.bind(this),this.getGrants=this.getGrants.bind(this),this.saveRoleGrantsClicked=this.saveRoleGrantsClicked.bind(this),this.expand=this.expand.bind(this),this.collapse=this.collapse.bind(this),this.deleteRoleControl=this.deleteRoleControl.bind(this),this.saveRoleGrantsControl=this.saveRoleGrantsControl.bind(this),this.editHandleCheckBoxChange=this.editHandleCheckBoxChange.bind(this),this.handleDelete=this.handleDelete.bind(this),this.onChangeDefaultPersonalStatus=this.onChangeDefaultPersonalStatus.bind(this),this.isExistDefaultPersonalRole=this.isExistDefaultPersonalRole.bind(this),this.getAssignedPersonalListForRole=this.getAssignedPersonalListForRole.bind(this),this.child=s.a.createRef()}componentDidMount(){this.getGrants()}getAssignedPersonalListForRole(e){let t={url:"/role/assignedPersonalListForRole",method:"post",data:{role:e,payload:this.arrangeDataSet(e)}};Object(o.e)(t).then((function(){C.a.success("\u0130ndirme talebiniz i\u015fleme al\u0131nd\u0131. 'Bekleyen \u0130ndirmeler'den' takip edebilirsiniz.",{position:"top-right",effect:"stackslide",timeout:8e3})})).catch((function(e){Object(f.v)(e)}))}isExistDefaultPersonalRole(e,t){let a=this,l={url:"/role/isExistDefaultPersonalRole",method:"post"};Object(o.e)(l).then((function(l){if(l.data){c()({title:"Uyar\u0131 ! ",text:"Ba\u015fka bir role Varsay\u0131lan Personel Rol\xfc tan\u0131mlanm\u0131\u015ft\u0131r.",confirmButtonText:"Tamam"}).then(()=>{});let l=Object.assign({},a.state.newRole);l[e]=!t,a.setState({newRole:l})}else{let l=Object.assign({},a.state.newRole);l[e]=t,a.setState({newRole:l})}})).catch((function(e){Object(f.v)(e)}))}saveDefaultPersonalRole(e){let t=this,a={url:"/role/createDefaultPersonelRole",method:"post",data:e};t.setState({disabledRoleSaveBtn:!0}),Object(o.e)(a).then((function(a){t.setState({disabledRoleSaveBtn:!1,approveAlert:null}),!1===a.data?(e.defaultPersonalRole=!1,t.setState({disabledRoleSaveBtn:!1,approveAlert:null,selectedRole:e}),c()({title:"Uyar\u0131 ! ",text:"Ba\u015fka bir role Varsay\u0131lan Personel Rol\xfc tan\u0131mlanm\u0131\u015ft\u0131r.",confirmButtonText:"Tamam"}).then(()=>{})):c()({title:"Ba\u015far\u0131l\u0131 ! ",text:"Kaydetme i\u015flemi ba\u015far\u0131yla ger\xe7ekle\u015ftirildi.",type:"success",confirmButtonText:"Tamam"}).then(()=>{})})).catch((function(e){Object(f.v)(e)}))}expand(){this.child.current.expandTree()}onChangeDefaultPersonalStatus(e,t){let a=this,l=e.target.checked;t.defaultPersonalRole=l,a.setState({selectedRole:t,approveAlert:s.a.createElement(R.a,{showCancel:!0,warning:!0,confirmBtnText:"Evet",cancelBtnText:"Hay\u0131r",confirmBtnBsStyle:"danger",cancelBtnBsStyle:"default",title:"",onConfirm:()=>a.saveDefaultPersonalRole(t),onCancel:()=>{t.defaultPersonalRole=!l,a.setState({selectedRole:t,approveAlert:null})}},l?"Bu rol\xfc Varsay\u0131lan Personel Rol\xfc olarak kaydedilmesini  onayl\u0131yor musunuz?":"Bu rolden Varsay\u0131lan Personel Rol\xfc yetkisi kald\u0131r\u0131lacakt\u0131r.")})}collapse(){this.child.current.collapseTree()}handleDelete(e){this.deleteRoleControl(e)}getGrants(){let e=this;e.setState({grantsLoading:!0}),Object(o.e)({url:"/role/getGrants",method:"get"}).then((function(t){t.data&&e.setState({grantsLoading:!1,grants:t.data})})).catch((function(t){e.setState({grantsLoading:!1}),Object(f.v)(t)}))}editHandleInputChange(e){const t=e.target;let a=t.value,l=t.name,s=Object.assign({},this.state.newRole);s[l]=a,this.setState({newRole:s})}editHandleCheckBoxChange(e){const t=e.target;let a=t.checked,l=t.name;this.isExistDefaultPersonalRole(l,a)}deleteRoleControl(e){e?e&&e.definedBySystem?c()({title:"Uyar\u0131 ! ",text:"Sistem taraf\u0131ndan tan\u0131mlanan rolleri silemezsiniz!",type:"warn",confirmButtonText:"Tamam"}).then(()=>{}):this.setState({approveAlert:s.a.createElement(R.a,{showCancel:!0,warning:!0,confirmBtnText:"Evet",cancelBtnText:"Hay\u0131r",confirmBtnBsStyle:"danger",cancelBtnBsStyle:"default",title:"",onConfirm:()=>this.deleteRole(e),onCancel:()=>this.setState({approveAlert:null})},e.roleName+" isimli rol\xfc silmek istiyor musunuz?")}):c()({title:"Uyar\u0131 ! ",text:"Silmek i\xe7in bir rol se\xe7iniz.",type:"warn",confirmButtonText:"Tamam"}).then(()=>{})}deleteRole(e){let t=this,a=t.state.searchQuery?"&"+t.state.searchQuery:"",l={url:"/role/deleteRole?page="+this.state.page+"&size="+this.state.size+a,method:"post",data:e};t.setState({approveAlert:null,loading:!0,disabledRoleDeleteBtn:!0}),Object(o.e)(l).then((function(e){e.data&&(t.setState({selectedRole:void 0,selectedRowNum:-1,content:e.data.content,loading:!1,disabledRoleDeleteBtn:!1}),c()({title:"Ba\u015far\u0131l\u0131 ! ",text:"Silme i\u015flemi ba\u015far\u0131yla ger\xe7ekle\u015ftirildi.",type:"success",confirmButtonText:"Tamam"}).then(()=>{t.fetchData()}))})).catch((function(e){t.setState({loading:!1,disabledRoleDeleteBtn:!1}),Object(f.v)(e)}))}saveRoleGrantsControl(){this.setState({approveAlert:s.a.createElement(R.a,{showCancel:!0,warning:!0,confirmBtnText:"Evet",cancelBtnText:"Hay\u0131r",confirmBtnBsStyle:"danger",cancelBtnBsStyle:"default",title:"",onConfirm:()=>this.saveRoleGrantsClicked(),onCancel:()=>this.setState({approveAlert:null})},this.state.selectedRole.roleName+" rol\xfcne ait yekileri kaydetmek istiyor musunuz?")})}saveRoleGrantsClicked(){let e=this,t=e.state.selectedRole;t.grants=[...new Set(e.child.current.state.selectedGrands)],e.setState({approveAlert:null,selectedRole:t,grantsLoading:!0}),e.child.current.setState({disabledTree:!0});let a={url:"/role/saveRoleGrants",method:"post",data:e.state.selectedRole};Object(o.e)(a).then((function(t){e.setState({grantsLoading:!1}),e.child.current.setCheckedBoxes(t.data.grants),e.child.current.setState({disabledTree:!1}),c()({title:"Ba\u015far\u0131l\u0131 ! ",text:"Role ait yetkiler ba\u015far\u0131l\u0131 bir\u015fekilde kaydedildi!",type:"success",confirmButtonText:"Tamam"}).then(()=>{e.setState({displayGrantSelectionDialog:!1}),e.fetchData(e.state.accessor,e.state.direction,0,e.state.size)})})).catch((function(t){e.setState({grantsLoading:!1}),e.child.current.setState({disabledTree:!1}),Object(f.v)(t)}))}editClicked(e){let t=Object.assign({},e);this.setState({newRole:t,displayUpdateRoleDialog:!0})}saveRoleClicked(){let e=this;if(void 0===e.state.newRole.roleName||""===e.state.newRole.roleName)return void c()({title:"Uyar\u0131 ! ",text:"L\xfctfen bir rol ad\u0131 giriniz!",type:"warn",confirmButtonText:"Tamam"}).then(()=>{});this.state.newRole.defaultPersonalRole=void 0!==e.state.newRole.defaultPersonalRole&&e.state.newRole.defaultPersonalRole;let t={url:"/role/createRole",method:"post",data:e.state.newRole};e.setState({disabledRoleSaveBtn:!0}),Object(o.e)(t).then((function(){e.setState({disabledRoleSaveBtn:!1,newRole:{defaultPersonalRole:!1,roleName:""},displayCreateRoleDialog:!1}),c()({title:"Ba\u015far\u0131l\u0131 ! ",text:"Kaydetme i\u015flemi ba\u015far\u0131yla ger\xe7ekle\u015ftirildi.",type:"success",confirmButtonText:"Tamam"}).then(()=>{e.fetchData()})})).catch((function(t){e.setState({disabledRoleSaveBtn:!1}),Object(f.v)(t)}))}updateRoleClicked(){let e=this;if(void 0===e.state.newRole.roleName||""===e.state.newRole.roleName)return void c()({title:"Uyar\u0131 ! ",text:"L\xfctfen bir rol ad\u0131 giriniz!",type:"warn",confirmButtonText:"Tamam"}).then(()=>{});this.state.newRole.defaultPersonalRole=void 0!==e.state.newRole.defaultPersonalRole&&e.state.newRole.defaultPersonalRole;let t={url:"/role/createRole",method:"post",data:e.state.newRole};e.setState({disabledRoleSaveBtn:!0}),Object(o.e)(t).then((function(){e.setState({disabledRoleSaveBtn:!1,newRole:{defaultPersonalRole:!1,roleName:""},displayUpdateRoleDialog:!1}),c()({title:"Ba\u015far\u0131l\u0131 ! ",text:"G\xfcncelleme i\u015flemi ba\u015far\u0131yla ger\xe7ekle\u015ftirildi.",type:"success",confirmButtonText:"Tamam"}).then(()=>{e.fetchData()})})).catch((function(t){e.setState({disabledRoleSaveBtn:!1}),Object(f.v)(t)}))}fetchData(e,t,a,l){let s=this,n=void 0!==e?"&sort="+e+","+t:"&sort=id,desc",i=s.state.searchQuery?"&"+s.state.searchQuery:"",r={url:"/role/getRoller?page="+a+"&size="+l+i+n,method:"get"};s.setState({loading:!0,searching:!0}),Object(o.e)(r).then((function(e){e.data.content.size>0&&(s.setState({selectedRole:e.data.content[0],selectedRowNum:1}),this.child.current.setCheckedBoxes(e.data.content[0].grants)),s.setState({loading:!1,content:e.data.content,page:a,size:l,total:e.data.totalElements,searching:!1})})).catch((function(e){s.setState({loading:!1,searching:!1}),Object(f.v)(e)}))}handleSearch(e){this.setState({searchQuery:e,searching:!0},()=>this.fetchData(this.state.accessor,this.state.direction,0,this.state.size))}onClickRole(e,t,a){this.setState({selectedRole:t,selectedRowNum:a}),this.child.current.setState({selectedChecks:[],selectedGrands:t.grants,disabledTree:t.definedBySystem}),this.child.current.setCheckedBoxes(t.grants)}renderCreate(){return s.a.createElement(n.Modal,{isOpen:this.state.displayCreateRoleDialog,size:"md",toggle:()=>this.setState({displayCreateRoleDialog:!1})},s.a.createElement(n.ModalHeader,{className:"justify-content-center",toggle:()=>this.setState({displayCreateRoleDialog:!1})}," Rol Tan\u0131mlama"),s.a.createElement(n.ModalBody,null,this.state.displayCreateRoleDialog&&s.a.createElement(E.a,{ref:this.notify}),s.a.createElement("div",null,s.a.createElement(n.Form,null,s.a.createElement(n.FormGroup,{row:!0},s.a.createElement(n.Label,{sm:4,for:"roleName"},"Rol Ad\u0131: *"),s.a.createElement(n.Col,{sm:8},s.a.createElement(n.Input,{type:"text",name:"roleName",value:null!==this.state.newRole?this.state.newRole.roleName:"",onChange:this.editHandleInputChange})))))),s.a.createElement(n.ModalFooter,null,s.a.createElement(n.Button,{title:"\u0130ptal",style:{paddingLeft:"16px",width:"100px"},color:"secondary",onClick:()=>this.setState({displayCreateRoleDialog:!1})},"\u0130ptal"),s.a.createElement(n.Button,{title:"Kaydet",style:{paddingLeft:"16px",width:"100px"},color:"primary",disabled:this.state.disabledRoleSaveBtn,onClick:this.saveRoleClicked},"Kaydet")))}renderUpdate(){return s.a.createElement(n.Modal,{isOpen:this.state.displayUpdateRoleDialog,size:"md",toggle:()=>this.setState({displayUpdateRoleDialog:!1})},s.a.createElement(n.ModalHeader,{className:"justify-content-center",toggle:()=>this.setState({displayUpdateRoleDialog:!1})}," Rol D\xfczenleme"),s.a.createElement(n.ModalBody,null,this.state.displayUpdateRoleDialog&&s.a.createElement(E.a,{ref:this.notify}),s.a.createElement("div",null,s.a.createElement(n.Form,null,s.a.createElement(n.FormGroup,{row:!0},s.a.createElement(n.Label,{sm:4,for:"roleName"},"Rol Ad\u0131: *"),s.a.createElement(n.Col,{sm:8},s.a.createElement(n.Input,{type:"text",name:"roleName",value:null!==this.state.newRole?this.state.newRole.roleName:"",onChange:this.editHandleInputChange})))))),s.a.createElement(n.ModalFooter,null,s.a.createElement(n.Button,{title:"\u0130ptal",style:{paddingLeft:"16px",width:"100px"},color:"secondary",onClick:()=>this.setState({displayUpdateRoleDialog:!1})},"\u0130ptal"),s.a.createElement(n.Button,{title:"Kaydet",style:{paddingLeft:"16px",width:"100px"},color:"primary",disabled:this.state.disabledRoleSaveBtn,onClick:this.updateRoleClicked},"Kaydet")))}renderGrants(){return s.a.createElement(n.Modal,{isOpen:this.state.displayGrantSelectionDialog,size:"lg",toggle:()=>this.setState({displayGrantSelectionDialog:!1})},s.a.createElement(n.ModalHeader,{className:"justify-content-center",toggle:()=>this.setState({displayGrantSelectionDialog:!1})}," Yetki Tan\u0131mlama"),s.a.createElement(n.ModalBody,null,this.state.displayGrantSelectionDialog&&s.a.createElement(E.a,{ref:this.notify}),s.a.createElement("div",null,s.a.createElement(n.Col,{sm:"12",style:{padding:0}},s.a.createElement("label",{style:{textAlign:"center",fontWeight:"bold"}},"Se\xe7ilen Rol :",void 0!==this.state.selectedRole?" "+this.state.selectedRole.roleName:" ")),s.a.createElement(n.Col,{sm:"12",style:{height:"60vh",overflow:"auto"}},s.a.createElement(p,{treeData:this.state.grants,ref:this.child,selectedData:this.state.selectedData,selectedRole:this.state.selectedRole}),this.state.grantsLoading&&s.a.createElement(g.a,{type:"spinningBubbles",style:{width:"70px",height:"70px",margin:"20px auto 0 auto",fill:"#888"}})))),s.a.createElement(n.ModalFooter,null,s.a.createElement(n.Button,{title:"\u0130ptal",style:{paddingLeft:"16px",width:"100px"},color:"secondary",onClick:()=>this.setState({displayGrantSelectionDialog:!1})},"\u0130ptal"),s.a.createElement(n.Button,{title:"Kaydet",style:{paddingLeft:"16px",width:"100px"},color:"primary",disabled:void 0!==this.state.selectedRole&&this.state.selectedRole.definedBySystem,onClick:this.saveRoleGrantsControl},"Kaydet")))}render(){const e=[{Header:"Rol Ad\u0131",accessor:"roleName",width:"65%"},{Header:"Sistem Tan\u0131ml\u0131",accessor:"isDefinedBySystem",Cell:e=>s.a.createElement("div",null,s.a.createElement("input",{type:"checkbox",checked:null!==e.definedBySystem&&e.definedBySystem,disabled:"disabled"})),width:"20%"},{Header:"\u0130\u015flemler",accessor:"",sortable:!1,width:"15%",Cell:(e,t)=>s.a.createElement("div",null,s.a.createElement(S.a,{title:"D\xfczenle",faIcon:"fa-edit",disabled:e.definedBySystem,onClick:()=>{this.editClicked(e)},color:"info"}),s.a.createElement(S.a,{title:"Yetki ekle",faIcon:"fa-plus",onClick:a=>{this.setState({displayGrantSelectionDialog:!0},()=>this.onClickRole(a,e,t))},color:"warning"}),s.a.createElement(S.a,{title:"Sil",faIcon:"fa-trash",color:"danger",onClick:()=>this.handleDelete(e,t),disabled:e.definedBySystem}),s.a.createElement(S.a,{title:"Role Atananlar\u0131n Listesi",faIcon:"fa-file-excel-o",onClick:()=>{this.getAssignedPersonalListForRole(e)},color:"success"}))}];return s.a.createElement("div",{className:"row baseBackground"},s.a.createElement(n.Nav,{className:"topbar",style:{paddingLeft:"14px",height:"53px"}},s.a.createElement(k.a,{offsetWidth:this.props.offsetWidth,innerWidth:window.innerWidth,btnDisabled:this.state.btnDisabled,name:"roleDefinition"},Object(f.f)(this,x.K)&&s.a.createElement(v.a,{position:"leftSide",className:"zocial Yeni",style:{fontSize:"x-small"},label:"Rol Olu\u015ftur",title:"Yeni Rol Olu\u015ftur",onClick:()=>this.setState({displayCreateRoleDialog:!0})}))),s.a.createElement("div",{className:"col-sm-12 satirBasi"},s.a.createElement("div",{className:"card-header"},s.a.createElement("h4",{className:"card-title"},"Rol Listesi")),s.a.createElement("div",{className:"card-body"},s.a.createElement(r.a,{fields:[{label:"Role Ad\u0131",accessor:"roleName",type:"text",operator:"="}],loading:this.state.searching,onSearch:this.handleSearch})),s.a.createElement("div",{className:"card-body"},s.a.createElement(i.a,{columns:e,content:this.state.content,loading:this.state.loading,total:this.state.total,page:this.state.page,manual:this.state.manual,size:this.state.size,options:["5","10","20","50","100"],fetchData:this.fetchData}))),this.state.approveAlert,this.renderCreate(),this.renderUpdate(),this.renderGrants(),!this.state.displayCreateRoleDialog&&s.a.createElement(E.a,{ref:this.notify}))}}t.default=D}}]);
//# sourceMappingURL=39.7d5aaeed.chunk.js.map