{"version":3,"sources":["common/hsm/HsmCertificateInput.js","accounting/kepik/inCorrectlySignedPdfFiles/IncorrectlySignedPdfFile.js"],"names":["HsmCertificateInput","Component","constructor","super","this","state","loading","loadCertificatesClicked","bind","changed","defaultHsmType","axios","Axios","create","baseURL","componentDidMount","url","props","value","hsmType","setState","certificateList","get","then","response","data","certificate","filter","element","keyUsage","some","element2","catch","error","alert","React","createElement","HsmErrorAlert","onConfirm","finally","key","val","clone","Object","assign","onChange","render","Container","Row","Label","sm","md","lg","Col","Input","type","disabled","e","target","label","map","i","NormalButton","color","faIcon","onClick","style","width","renderCertificateSelecter","renderEmptyCertificateSelector","keyUsageMap","DIGITAL_SIGNATURE","NON_REPUDIATION","KEY_ENCIPHERMENT","DATA_ENCIPHERMENT","KEY_AGREEMENT","KEY_CERT_SIGN","CRL_SIGN","ENCIPHER_ONLY","DECIPHER_ONLY","keyId","find","l","commonName","serial","validFrom","expiresOn","index","minHeight","position","ReactErrorTop","height","transparent","ReactLoadingTop","IncorrectlySignedPdfFile","uploadZip","file","depo","document","getElementById","click","downloadZip","requestK","method","responseType","blob","Blob","headers","window","URL","webkitURL","createObjectURL","a","body","appendChild","href","download","showAxiosError","renderPin","pdfs","length","percentage","signedDocumentCount","progressLength","autoComplete","pin","Button","title","showSigned","marginTop","marginLeft","padding","margin","signClicked","right","bottom","background","borderRadius","display","alignItems","className","Progress","Math","round","p","Promise","resolve","documents","signedDoc","forEach","post","hsmInput","base64","signedInfo","push","id","signature","signedDocument","writeSignedDoc","result","completed","disableButton","signedMissingDoc","self","params","timeout","prevState","onFileDrop","formData","FormData","append","onChangeHsmInput","fetchData","page","size","accessor","direction","sortStr","total","totalElements","content","canUpload","timer","timerStarted","componentDidUpdate","setInterval","Alert","success","effect","history","pathname","peykName","renderNavButtons","Nav","paddingLeft","isSuperAdmin","StickButton","fontSize","Fragment","Form","accept","event","files","CardHeader","CardTitle","tag","CardBody","mediaModal","ApproveDocumentViewer","modal","closeModal","previewContent","row"],"mappings":"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","file":"static/js/52.93cbf620.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport { Input, Container, Row, Col, Label } from 'reactstrap';\nimport Axios from 'axios'\nimport HsmErrorAlert from './HsmErrorAlert'\nimport NormalButton from '../../components/NormalButton'\nimport ReactErrorTop from '../../components/ReactErrorTop'\nimport ReactLoadingTop from '../../components/ReactLoadingTop'\n\nclass HsmCertificateInput extends Component {\n\n  constructor() {\n    super();\n\n    this.state = {\n      loading: false\n    };\n\n    this.loadCertificatesClicked = this.loadCertificatesClicked.bind(this);\n    this.changed = this.changed.bind(this);\n    this.defaultHsmType = \"akis\";\n\n    this.axios = Axios.create({\n      baseURL: \"http://127.0.0.1:9999\"\n    });\n  }\n\n  componentDidMount() {\n  }\n\n  loadCertificatesClicked() {\n    let url = \"/certificate?hsmtype=\" + ((this.props.value && this.props.value.hsmType) || this.defaultHsmType);\n\n    this.setState({\n      loading: true,\n      certificateList: null\n    });\n\n    this.axios.get(url)\n      .then((response) => {\n\n        let certificateList = response.data.certificate.filter((element) => {\n          return element.keyUsage.some((element2) => {\n            return element2 === \"DIGITAL_SIGNATURE\";\n          });\n        });\n\n        this.setState({\n          certificateList: certificateList\n        });\n\n        this.changed(\"certificate\",  certificateList[0]);\n      })\n      .catch((error) => {\n      \n        this.setState({\n          alert: <HsmErrorAlert error={error} onConfirm={() => this.setState({alert: null})} />\n        });\n      })\n      .finally(() => {\n        this.setState({loading: false});\n      });\n  }\n\n  changed(key, val) {\n    let clone = Object.assign({}, this.props.value);\n    clone[key] = val;\n\n    if (key === \"hsmType\") {\n      clone.certificate = null;\n      this.setState({certificateList: null});\n    }\n\n    if (!clone.hsmType)\n      clone.hsmType = this.defaultHsmType;\n\n    if (this.props.onChange) {\n      this.props.onChange(clone);\n    }\n  }\n\n  render() {\n\n    let hsmTypeList = [\n      {label: \"Akis\", value: \"akis\"},\n      {label: \"GemSafe\", value: \"gemsafe\"},\n      {label: \"Seimens\", value: \"seimens\"},\n      {label: \"StarCOS\", value: \"starcos\"},\n      {label: \"Aladdin\", value: \"aladdin\"}\n      ];\n\n    return <Container>\n      {this.state.alert}\n      <Row>\n        <Label sm={12} md={3} lg={3}>Akıllı kart markası</Label>\n        <Col sm={12} md={5} lg={5}>\n          <Input type=\"select\" disabled={this.props.disabled} value={(this.props.value && this.props.value.hsmType) || this.defaultHsmType}  onChange={(e) => {this.changed(\"hsmType\", e.target.value)}}>\n            {hsmTypeList.map((e, i) => <option key={i} value={e.value}>{e.label}</option>)}\n          </Input>\n        </Col>\n        <Col sm={12} md={4} lg={4}>\n          <NormalButton disabled={this.props.disabled} color=\"primary\" faIcon=\"fa-sync-alt\" onClick={this.loadCertificatesClicked} style={{width: \"100%\"}}>\n            Sertifikaları getir\n          </NormalButton>\n        </Col>\n      </Row>\n      <Row>\n        {this.state.certificateList && this.props.value && this.props.value.certificate ?\n          this.renderCertificateSelecter() :\n          this.renderEmptyCertificateSelector()}\n      </Row>\n\t\t</Container>\n  }\n\n  renderCertificateSelecter() {\n\n    let keyUsageMap = {\n      DIGITAL_SIGNATURE: \"Dijital imza\",\n      NON_REPUDIATION: \"Reddedilememe\",\n      KEY_ENCIPHERMENT: \"Anahtar şifreleme\",\n      DATA_ENCIPHERMENT: \"Veri şifreleme\",\n      KEY_AGREEMENT: \"Anahtar anlaşması\",\n      KEY_CERT_SIGN: \"Sertifika imzalama\",\n      CRL_SIGN: \"Sertifia iptal listesi imzalama\",\n      ENCIPHER_ONLY: \"Sadece şifreleme\",\n      DECIPHER_ONLY: \"Sadece çözme\",\n    };\n\n    return <Container>\n      <Row>\n        <Col sm={12}>\n          <Input type=\"select\" disabled={this.props.disabled} value={this.props.value.certificate.keyId}\n                 onChange={(e) => {this.changed(\"certificate\", this.state.certificateList.find((l) => (l.keyId === e.target.value)))}}>\n            {this.state.certificateList.map(e => <option key={e.keyId} value={e.keyId}>{e.commonName}</option>)}\n          </Input>\n        </Col>\n      </Row>\n      {this.props.value && this.props.value.certificate &&\n      <Container>\n        <Row>\n          <Col sm={12} md={4}>\n            <label>Ortak ad</label>\n          </Col>\n          <Col sm={12} md={8}>\n            {this.props.value.certificate.commonName}\n          </Col>\n        </Row>\n        <Row>\n          <Col sm={12} md={4}>\n            <label>Seri no</label>\n          </Col>\n          <Col sm={12} md={8}>\n            {this.props.value.certificate.serial}\n          </Col>\n        </Row>\n        <Row>\n          <Col sm={12} md={4}>\n            <label>Geçerlilik baslangıcı</label>\n          </Col>\n          <Col sm={12} md={8}>\n            {this.props.value.certificate.validFrom}\n          </Col>\n        </Row>\n        <Row>\n          <Col sm={12} md={4}>\n            <label>Geçerlilik sonu</label>\n          </Col>\n          <Col sm={12} md={8}>\n            {this.props.value.certificate.expiresOn}\n          </Col>\n        </Row>\n        <Row>\n          <Col sm={12} md={4}>\n            <label>Anahtar kullanımı</label>\n          </Col>\n          <Col sm={12} md={8}>\n            <ul>\n              {this.props.value.certificate.keyUsage.map((element, index) => {\n                return <li key={index}>{keyUsageMap[element]}</li>\n              })}\n            </ul>\n          </Col>\n        </Row>\n      </Container>\n      }\n    </Container>\n  }\n\n  renderEmptyCertificateSelector() {\n    return <Col sm={12}>\n      <div style={{minHeight: '180px', position: 'relative'}}>\n        {!this.state.loading && <ReactErrorTop type=\"usb\" style={{width: '90px', height: '90px'}} transparent/>}\n        {this.state.loading && <ReactLoadingTop style={{width: '90px', height: '90px'}} transparent/>}\n    </div>\n    </Col>\n  }\n}\n\nexport default HsmCertificateInput;\n","import React, {Component} from 'react';\nimport {\n  Button,\n  CardBody,\n  CardHeader,\n  CardTitle,\n  Col,\n  Container,\n  Form,\n  Input,\n  Label,\n  Nav,\n  Progress,\n  Row\n} from 'reactstrap';\nimport StickButton from \"../../../components/StickButton\";\nimport Table from \"../../../components/Table/Table\";\nimport {requestK} from \"../../../helper/APIUtils\";\nimport {showAxiosError} from \"../../../helper/helper\";\nimport HsmCertificateInput from \"../../../common/hsm/HsmCertificateInput\";\nimport MiniButton from \"../../../components/MiniButton\";\nimport ApproveDocumentViewer from \"../approval/helper/ApproveDocumentViewer\";\nimport HsmErrorAlert from \"../../../common/hsm/HsmErrorAlert\";\nimport Axios from \"axios\";\nimport Alert from \"react-s-alert\";\n\nclass IncorrectlySignedPdfFile extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      pdfs: [],\n      total: 0,\n      page: 0,\n      size: 250,\n      loading: false,\n      canUpload: false,\n      certificate: null,\n      showSigned: false,\n      signedDocumentCount: 0,\n      progressLength: 1,\n      timer: 1,\n      timerStarted: false,\n    }\n  }\n\n  componentDidMount() {\n    this.axios = Axios.create({baseURL: \"http://127.0.0.1:9999\"});\n\n    requestK({\n      url: `/missing-signature/can-upload`,\n      method: \"get\",\n    }).then((response) => {\n      this.setState({canUpload: response.data});\n    }).catch((error) => {\n      this.setState({canUpload: false});\n    });\n  }\n\n  componentDidUpdate() {\n    if (this.state.timer === 1 && !this.state.timerStarted &&\n      this.state.completed && this.state.signedDocumentCount === this.state.progressLength) {\n      setInterval(() => {\n        this.setState(prevState => ({timer: prevState.timer - 1}))\n      }, 1000);\n      this.setState({timerStarted: true});\n    } else if (this.state.timer === 0) {\n      Alert.success('İmzalama işlemi başarılı.', {\n        position: 'top-right',\n        effect: 'stackslide',\n        timeout: 5000\n      });\n      this.props.history.push({pathname: `/${this.props.peykName}/hr-dashboard`});\n    }\n  }\n\n  renderNavButtons() {\n    return (\n      <Nav className=\"topbar\" style={{paddingLeft: '14px', height: '53px'}}>\n        {\n          (this.state.canUpload && this.props.isSuperAdmin) &&\n          <StickButton position=\"leftSide\" className=\"zocial Yeni\" style={{fontSize: 'x-small'}}\n                       label=\"Zip İndir\" title=\"Dokümanı İmzala\"\n                       onClick={this.downloadZip}\n          />\n        }\n        {\n          (this.state.canUpload && this.props.isSuperAdmin) &&\n          <StickButton position=\"leftSide\" className=\"zocial Yeni\" style={{fontSize: 'x-small'}}\n                       label=\"Zip Yukle\" title=\"Dokümanı İmzala\"\n                       onClick={this.uploadZip}\n          />\n        }\n      </Nav>\n    );\n  }\n\n  uploadZip = () => {\n    this.setState({file: null, depo: \"GEK\"});\n    document.getElementById('upload-file').value = null;\n    document.getElementById('upload-file').click();\n  };\n\n\n  downloadZip = () => {\n    requestK({\n      url: `/missing-signature/downloadAllZipped`,\n      method: \"post\",\n      responseType: 'arraybuffer'\n    }).then((response) => {\n      let blob = new Blob([response.data], {type: response.headers[\"content-type\"]});\n      let urlCreator = window.URL || window.webkitURL;\n      let url = urlCreator.createObjectURL(blob);\n      let a = document.createElement(\"a\");\n      document.body.appendChild(a);\n      a.style = \"display: none\";\n      a.href = url;\n      a.download = \"all.zip\";\n      a.click();\n    }).catch(error => {\n      showAxiosError(error)\n    });\n  };\n\n  render() {\n\n    const columns = [\n      {\n        Header: \"Doküman Adı\",\n        accessor: \"docName\",\n      },\n      {\n        Header: \"İşlemler\",\n        accessor: \"\",\n        sortable: false,\n        width: \"10%\",\n        Cell: row => (\n          <div style={{textAlign: 'left'}}>\n            <MiniButton title=\"Görüntüle\" faIcon=\"fa-eye\" color=\"info\"\n                        onClick={() => this.previewContent(row)}/>\n          </div>\n        )\n      }\n    ]\n\n    return (\n      <>\n        <div className=\"row baseBackground\">\n          {this.renderNavButtons()}\n          <div className=\"col-sm-12 satirBasi\">\n            {\n              this.state.canUpload &&\n              <Form>\n                <input type=\"file\" accept=\".zip\" style={{display: 'none'}}\n                       id={\"upload-file\"}\n                       onChange={event => {\n                         this.onFileDrop(event.target.files[0]);\n                       }}\n                />\n              </Form>\n            }\n            <CardHeader>\n              <CardTitle tag=\"h4\">\n              </CardTitle>\n            </CardHeader>\n            <CardBody>\n              <HsmCertificateInput value={this.state.hsmInput}\n                                   disabled={this.state.loading}\n                                   onChange={this.onChangeHsmInput}/>\n              {this.renderPin()}\n              {/*{*/}\n              {/*  this.state.certificate &&*/}\n              {/*  <Table*/}\n              {/*    columns={columns}*/}\n              {/*    content={this.state.pdfs}*/}\n              {/*    total={this.state.total}*/}\n              {/*    page={this.state.page}*/}\n              {/*    size={this.state.size}*/}\n              {/*    loading={this.state.loading}*/}\n              {/*    options={[\"5\", \"10\", \"20\", \"50\", \"100\"]}*/}\n              {/*    fetchData={this.fetchData}*/}\n              {/*    manual={this.state.manual}*/}\n              {/*  />*/}\n              {/*}*/}\n            </CardBody>\n          </div>\n        </div>\n        {this.state.mediaModal &&\n        <ApproveDocumentViewer url={this.state.url}\n                               modal={this.state.mediaModal}\n                               closeModal={() => this.setState({url: null, mediaModal: false})}\n        />}\n        {this.state.alert}\n      </>\n    );\n  }\n\n  renderPin = () => {\n    if (this.state.pdfs && this.state.pdfs.length > 0) {\n      let percentage = this.state.signedDocumentCount * 100 / this.state.progressLength;\n      return <Container>\n        <Row>\n          <Label sm={12} md={3} disabled={true}>Pin</Label>\n          <Col sm={12} md={5}>\n            <Input type=\"password\" autoComplete=\"off\" disabled={this.state.loading} value={this.state.pin}\n                   onChange={e => {\n                     this.setState({pin: e.target.value})\n                   }}/>\n          </Col>\n          <Col sm={12} md={4}>\n            <Button title={\"İmzala\"} color=\"success\"\n                    disabled={this.state.loading || !this.state.pin || this.state.showSigned}\n                    style={{\n                      position: 'relative',\n                      width: '50%',\n                      height: '30px',\n                      marginTop: '-7px',\n                      marginLeft: '-5px',\n                      padding: '0 5% 0 0',\n                      margin: 0,\n                    }}\n                    onClick={this.signClicked}>\n            <span\n              style={{\n                position: 'absolute',\n                right: '0px',\n                bottom: 0,\n                padding: '11px 10px',\n                height: '30px',\n                background: 'rgba(0,0,0,0.15)',\n                borderRadius: '3px 0 0 3px',\n                display: 'flex',\n                alignItems: 'center'\n              }}>\n                <i className=\"fa fa-check\"/>\n            </span>\n              İmzala\n            </Button>\n\n\n          </Col>\n        </Row>\n        <Row style={{marginTop: '1em'}}>\n          <div className=\"col-sm-12\" >\n            <Progress value={percentage}>{\"%\" + Math.round(percentage)}</Progress>\n          </div>\n        </Row>\n      </Container>\n    }\n  };\n\n  signClicked = () => {\n    let p = Promise.resolve([]);\n    let documents = this.state.pdfs;\n    let signedDoc = [];\n\n    this.setState({progressLength: documents.length, loading: true, showSigned: true});\n    documents.forEach((document, index) => {\n      p = p.then((response) => {\n        return this.axios.post(\"/signature/signedinfo?hsmtype=\" + this.state.hsmInput.hsmType, {\n          base64: true,\n          pin: this.state.pin,\n          signedInfo: document.signedInfo,\n          certificate: {\n            keyId: this.state.hsmInput.certificate.keyId\n          }\n        }).then((response) => {\n          signedDoc.push({\n            id: document.id,\n            signature: response.data.signedDocument\n          });\n          this.writeSignedDoc(signedDoc);\n          signedDoc = [];\n        });\n      });\n    });\n\n    p.then((result) => {\n      this.setState({\n        loading: false,\n        completed: true\n      });\n    }).catch(error => {\n      this.setState({\n        loading: false,\n        completed: false,\n        disableButton: false,\n        alert: <HsmErrorAlert error={error} onConfirm={() => this.setState({alert: null})}/>\n      });\n    });\n  };\n\n  writeSignedDoc = (signedMissingDoc) => {\n    let self = this;\n    let params = {\n      url: `/missing-signature/writePdfSignatures`,\n      method: \"post\",\n      data: signedMissingDoc,\n      timeout: 9600000\n    };\n    requestK(params)\n      .then(function (response) {\n        self.setState((prevState, props) => {\n          return {signedDocumentCount: prevState.signedDocumentCount + 1}\n        });\n      }).catch(function (error) {\n      showAxiosError(error);\n    });\n  };\n\n  previewContent(row) {\n    let self = this;\n    let params = {\n      url: `/missing-signature/downloadContent?id=${row.id}`,\n      responseType: 'arraybuffer',\n      method: \"post\"\n    };\n    self.setState({mediaModal: true});\n    requestK(params)\n      .then(function (response) {\n        let blob = new Blob([response.data], {type: response.headers[\"content-type\"]});\n        let urlCreator = window.URL || window.webkitURL;\n        let url = urlCreator.createObjectURL(blob);\n        self.setState({url});\n      }).catch(function (error) {\n      showAxiosError(error);\n      self.setState({mediaModal: false, title: null});\n    });\n  }\n\n  onFileDrop = (file) => {\n    if (!file && file === null)\n      return;\n    let formData = new FormData();\n    formData.append(\"content\", file);\n    requestK({\n      url: `/missing-signature/uploadAllZip`,\n      method: \"post\",\n      data: formData\n    }).then(() => {\n    }).catch(error => showAxiosError(error));\n  };\n\n  onChangeHsmInput = (hsmInput) => {\n    this.setState({hsmInput});\n    if (!!hsmInput.certificate) {\n      this.setState({certificate: hsmInput.certificate});\n      this.fetchData(null, null, this.state.page, this.state.size)\n    }\n  };\n\n  fetchData = (accessor, direction, page, size) => {\n    let sortStr = !!accessor ? ('&sort=' + accessor + ',' + direction) : '&sort=id,desc';\n    this.setState({loading: true});\n    requestK({\n      url: `/missing-signature/missings?page=${page}&size=${size}${sortStr}`,\n      method: \"post\",\n      data: this.state.certificate.keyId\n      // data: 'iagzppMJ02o='\n    }).then((response) => {\n      this.setState({total: response.data.totalElements, pdfs: response.data.content, loading: false});\n    }).catch((error) => {\n      this.setState({loading: false});\n      showAxiosError(error);\n    });\n  };\n\n}\n\nexport default IncorrectlySignedPdfFile;"],"sourceRoot":""}