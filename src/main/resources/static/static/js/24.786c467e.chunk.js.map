{"version":3,"sources":["accounting/kepik/bordrosession/helper/ProcessCode.js","accounting/kepik/bordro/component/BordroTableIdSelected.js","accounting/kepik/bordrosession/SignBordroMailPage.js"],"names":["ProcessCode","SIGNBORDRO","code","SIGNMIME","RESENDMIME","BordroTableIdSelected","Component","constructor","props","super","getEmployeeId","async","self","this","params","url","state","content","employee","id","method","response","requestK","setState","employeeUserId","data","error","showAxiosError","loading","getApprovalUserId","approvalUserId","alert","selection","manual","total","page","size","fetchData","bind","previewBordro","setMediaViewer","accessor","direction","sortStr","undefined","processCode","selectedBordroIdList","searching","then","bordroSession","totalElements","React","createElement","SweetAlert","confirmBtnText","confirmBtnBsStyle","title","onConfirm","history","push","pathname","peykName","toggleModal","length","message","Alert","warning","position","effect","timeout","updateFlowTimeout","onComplete","selectedIdList","readFlowTimeoutTemplate","readTimeoutTemplate","catch","mediaModal","row","responseType","blob","Blob","type","headers","base64Data","reader","FileReader","readAsDataURL","onloadend","result","render","columnList","Header","Cell","term","moment","format","name","className","parsedTckn","surname","kepAddress","style","margin","warningCount","DocumentState","messageType","sortable","textAlign","onClick","e","columns","renewListForKepOwnership","isKepOwner","ApproveDocumentViewer","modal","listener","closeModal","Table","options","SignBordroMailPage","readSmsTemplate","smsBody","readMailTemplate","mimeBody","isNoTemplateValid","mimeTitle","trim","completed","signedDocumentCount","progressLength","pageState","timer","timerStarted","certError","disableButton","signBordros","writeSignedBordro","updatePdfCertificates","stateMap","0","label","10","wait","20","30","40","danger","componentDidMount","axios","Axios","create","baseURL","location","monthNames","yearInput","monthInput","componentDidUpdate","setInterval","prevState","from","signed","unsigned","updateMailInfo","bordroSessionId","body","selectedBordros","timerStatus","status","onTimerStatus","hsmType","pdfCertificate","certificate","value","certificateKeyId","keyId","JSON","stringify","bordroIdList","signedInfoList","signedBordro","element","pdfName","post","base64","pin","signedInfo","signature","signedDocument","info","window","HsmErrorAlert","renderNavButtons","Nav","paddingLeft","height","StickButton","fontSize","disabled","showCancel","cancelBtnText","cancelBtnBsStyle","onCancel","renderState","marginBottom","Col","sm","md","display","marginRight","ReactLoading","color","width","top","lineHeight","paddingRight","opacity","fontWeight","renderMailInputs","Row","Input","marginTop","onChange","target","rows","border","padding","renderBordroList","pageSize","flag","Notify","ref","Card","CardHeader","CardTitle","tag","CardBody","HsmCertificateViewer","sessionId","val","pinValueChange","certificateError","bordroName","displayCertificateMenu","userId","currentUser"],"mappings":"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","file":"static/js/24.786c467e.chunk.js","sourcesContent":["let ProcessCode = {\n    SIGNBORDRO: {\n        code: 0\n    },\n    SIGNMIME: {\n        code: 1\n    },\n    RESENDMIME: {\n        code: 2\n    }\n};\n\nexport default ProcessCode;","import React, {Component} from 'react';\nimport Table from \"../../../../components/Table/Table\";\nimport SweetAlert from 'react-bootstrap-sweetalert';\nimport 'react-datetime/css/react-datetime.css'\nimport moment from 'moment';\nimport 'moment/locale/tr'\nimport Alert from \"react-s-alert\";\nimport ProcessCode from \"../../bordrosession/helper/ProcessCode\";\nimport {showAxiosError} from \"../../../../helper/helper\";\nimport {requestK} from \"../../../../helper/APIUtils\";\nimport {renewListForKepOwnership} from \"../../common/PeykHelper\";\nimport DocumentState from \"../../common/DocumentState\";\nimport ApproveDocumentViewer from \"../../approval/helper/ApproveDocumentViewer\";\n\nclass BordroTableIdSelected extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      alert: null,\n      selection: [],\n      manual: false,\n      content: [],\n      total: 0,\n      page: 0,\n      size: 10\n    };\n    this.fetchData = this.fetchData.bind(this);\n    this.previewBordro = this.previewBordro.bind(this);\n    this.setMediaViewer = this.setMediaViewer.bind(this);\n  }\n\n  getEmployeeId = async () => {\n    let self = this;\n    let employeeId = this.state.content[0].employee.id;\n    let params = {\n      url: `/employee/getEmployeeId/${employeeId}`,\n      method: \"post\"\n    };\n\n    try {\n      let response = await requestK(params);\n      self.setState({\n        employeeUserId: response.data\n      });\n    } catch (error) {\n      showAxiosError(error);\n      self.setState({ loading: false });\n    }\n  };\n\n  getApprovalUserId = async () => {\n    let self = this;\n    let approvalId = this.state.content[0].id;\n    let params = {\n      url: `/approval/getApprovalUserId/${approvalId}`,\n      method: \"post\"\n    };\n\n    try {\n      let response = await requestK(params);\n      self.setState({\n        approvalUserId: response.data\n      });\n    } catch (error) {\n      showAxiosError(error);\n      self.setState({ loading: false });\n    }\n  };\n\n  fetchData(accessor, direction, page, size) {\n    let self = this;\n    let sortStr = accessor !== undefined ? ('&sort=' + accessor + ',' + direction) : '';\n    let params = {\n      url: '/bordro/readBordroAllByIds?processCode=' + self.props.processCode + '&page=' + page + '&size=' + size + sortStr,\n      method: \"post\",\n      data: self.props.selectedBordroIdList\n    };\n    self.setState({loading: true, searching: true, manual: self.manual === true ? false : self.manual});\n    requestK(params)\n        .then(async function (response) {\n        let id = self.props.bordroSession && self.props.bordroSession.id;\n        if (response.data.page && response.data.page.totalElements === 0) {\n          self.setState({\n            alert: (<SweetAlert error\n                                confirmBtnText=\"Tamam\"\n                                confirmBtnBsStyle=\"danger\"\n                                title=\"Hata\"\n                                onConfirm={() => {\n                                  id ?\n                                    self.props.history.push({pathname: `/${self.props.peykName}/bordroimport/` + id}) :\n                                    self.setState({alert: null});\n                                    self.props.toggleModal && self.props.toggleModal(true);\n                                }}>\n              {self.props.processCode === ProcessCode.RESENDMIME.code && \"Seçilen alıcıların onayda bekleyen gönderileri bulunmamaktadır.\"}\n              {self.props.processCode === ProcessCode.SIGNBORDRO.code && \"Seçilen ücret bordrolarının imzalı iletiler bulunduğu veya çalışan eşleşmesi yapılmamış olduğu için bu işlem yapılamaz.\"}\n              {self.props.processCode === ProcessCode.SIGNMIME.code && \"Seçilen ücret bordrolarının imzalı iletiler bulunduğu veya çalışan eşleşmesi yapılmamış olduğu için bu işlem yapılamaz.\"}\n            </SweetAlert>),\n            loading: false\n          });\n          return;\n        } else if (response.data.page && response.data.page.totalElements < self.props.selectedBordroIdList.length) {\n          self.props.toggleModal(false);\n          let message = self.props.processCode === ProcessCode.RESENDMIME.code ? 'Tekrar gönderime hazır bordrolar seçilmiştir.' :\n            (self.props.processCode === ProcessCode.SIGNBORDRO.code ? 'Çalışan eşleşmesi olmayanlar ve daha önce gönderilmiş bordro listeden çıkarılmıştır.' :\n              'Çalışan eşleşmesi olmayanlar ve daha önce gönderilmiş bordro listeden çıkarılmıştır.');\n          Alert.warning(message, {\n            position: 'top-right',\n            effect: 'stackslide',\n            timeout: 8000\n          });\n        }\n\n        self.setState({\n          page: page,\n          size: size,\n          total: response.data.page && response.data.page.totalElements,\n          content: response.data.page && response.data.page.content,\n          loading: false\n        }, () => {\n          if (response.data.page.content[0].state === \"FLOW_TIMEOUT\") {\n            self.props.updateFlowTimeout(true);\n          }\n        self.props.onComplete(response.data.selectedIdList);\n        });\n          if(response.data.page.content[0].state === 'FLOW_TIMEOUT'){\n            await self.getEmployeeId();\n            await self.getApprovalUserId();\n            if (self.state.approvalUserId === self.state.employeeUserId) {\n              self.props.readFlowTimeoutTemplate();\n            } else {\n              self.props.readTimeoutTemplate();\n            }\n          }\n      }).catch(function (error) {\n      self.setState({loading: false});\n      showAxiosError(error);\n    });\n  }\n\n  setMediaViewer() {\n    this.setState({url: null, mediaModal: false});\n  }\n\n  previewBordro(row) {\n    let self = this;\n    let params = {\n      url: `/bordro/previewBordroContent`,\n      responseType: 'arraybuffer',\n      method: \"post\",\n      data: row.id\n    };\n    self.setState({mediaModal: true});\n    requestK(params)\n      .then(function (response) {\n        let blob = new Blob([response.data], {type: response.headers[\"content-type\"]});\n        let base64Data=\"\";\n        if (blob != undefined) {\n          let reader = new FileReader();\n          reader.readAsDataURL(blob);\n          reader.onloadend = function() {\n            base64Data = reader.result;\n            self.setState({url: base64Data});\n          }\n        }\n      }).catch(function (error) {\n      showAxiosError(error);\n      self.setState({mediaModal: false});\n    });\n  }\n\n  render() {\n\n    let columnList = [\n      {\n        Header: \"Dönem\",\n        accessor: \"term\",\n        Cell: row => (\n          <div>\n            {!!row.term && moment(row.term, 'YYYY/MM/DD').format('YYYY/MM')}\n          </div>\n        )\n      },\n      {\n        Header: \"TCKN\",\n        accessor: \"parsedTckn\",\n        Cell: row => (\n          <div>\n            {(row.employee && row.employee.name) && <span className=\"text-success\">{row.parsedTckn}</span>}\n            {!(row.employee && row.employee.name) && <span className=\"text-danger\">{row.parsedTckn}</span>}\n          </div>\n        )\n      },\n      {\n        Header: \"Adı\",\n        accessor: \"employee_name\",\n        Cell: row => (<div>{row.employee && row.employee.name}</div>\n        )\n      },\n      {\n        Header: \"Soyadı\",\n        accessor: \"employee_surname\",\n        Cell: row => (<div>{row.employee && row.employee.surname}</div>\n        )\n      },\n      {\n        Header: \"Kep Adresi\",\n        accessor: \"employee_kepAddress\",\n        Cell: row => (\n          <div>\n            {row.employee && row.employee.kepAddress}\n          </div>\n        )\n      },\n      {\n        Header: \"Uyarı Sayısı\",\n        accessor: \"warningCount\",\n        Cell: row => (\n            <div style={{margin: 0}}>\n              {row.warningCount}\n            </div>\n        )\n      },\n      {\n        Header: \"Durumu\",\n        accessor: \"state\",\n        Cell: row => (\n          <div>\n            {row.error && <span className=\"text-danger\">{row.error}</span>}\n            {!row.error &&\n            <span\n              className={\"text-\" + DocumentState[row.state].messageType}>{DocumentState[row.state].message}</span>}\n          </div>\n        )\n      },\n      {\n        Header: \"İşlemler\",\n        sortable: false,\n        accessor: \"\",\n        Cell: row => (\n          <div style={{textAlign: 'left'}}>\n            <button title=\"Ücret Bordrosu Görüntüle\" className=\"btn-icon btn btn-info btn-sm\"\n                    style={{margin: '0px 3px'}}\n                    onClick={e => this.previewBordro(row)}>\n              <i className=\"now-ui-icons ui-1_zoom-bold\"/>\n            </button>\n          </div>\n        )\n      }\n    ];\n    let columns = renewListForKepOwnership(columnList, \"accessor\", this.props.isKepOwner);\n    return <div>\n      {this.state.mediaModal &&\n      <ApproveDocumentViewer modal={this.state.mediaModal}\n                             url={this.state.url}\n                             title=\"Ücret Bordrosu\"\n                             listener={this.setMediaViewer}\n                             closeModal={this.setMediaViewer}/>\n      }\n      <Table columns={columns}\n             content={this.state.content}\n             loading={this.props.loading ? this.props.loading : this.state.loading}\n             total={this.state.total}\n             page={this.state.page}\n             manual={this.state.manual}\n             size={this.state.size}\n             options={[\"5\", \"10\", \"20\", \"50\", \"100\"]}\n             fetchData={this.fetchData}\n      />\n      {this.state.alert}\n    </div>;\n  }\n}\n\nexport default BordroTableIdSelected;\n","import React, {Component} from 'react';\nimport {Card, CardBody, CardHeader, CardTitle, Col, Input, Nav, Row} from 'reactstrap';\nimport 'react-table/react-table.css'\nimport SweetAlert from 'react-bootstrap-sweetalert';\nimport Notify from 'react-notification-alert';\nimport 'react-datetime/css/react-datetime.css'\nimport 'moment/locale/tr'\nimport Axios from 'axios'\nimport HsmErrorAlert from '../../../common/hsm/HsmErrorAlert'\nimport HsmCertificateViewer from '../common/HsmCertificateViewer';\nimport BordroTableIdSelected from \"../bordro/component/BordroTableIdSelected\";\nimport ReactLoading from 'react-loading';\nimport StickButton from \"../../../components/StickButton\";\nimport ProcessCode from \"./helper/ProcessCode\";\nimport {requestK} from \"../../../helper/APIUtils\";\nimport {showAxiosError} from \"../../../helper/helper\";\nimport moment from \"moment\";\nimport Alert from \"react-s-alert\";\n\nclass SignBordroMailPage extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      completed: false,\n      signedDocumentCount: 0,\n      progressLength: 1,\n      pageState: 0,\n      selectedBordroIdList: [],\n      timer: 1,\n      timerStarted: false,\n      certError: true,\n      disableButton: false\n    };\n\n    this.signBordros = this.signBordros.bind(this);\n    this.writeSignedBordro = this.writeSignedBordro.bind(this);\n    this.updatePdfCertificates = this.updatePdfCertificates.bind(this);\n\n    this.stateMap = {\n      0: {\n        label: \"Bordro dosyaları imzalama için hazır. İmzalayınız\",\n      },\n      // İmzala'ya basıldı -> 1.E-posta bilgileri alınıyor\n      10: {\n        label: \"İletiler oluşturuluyor. Lütfen, sayfayı terk etmeyiniz.\",\n        wait: true\n      },\n      // İmzala'ya basıldı -> 2.Sertifika session'a kaydediliyor\n      //                   -> 3.SignedInfo Üretilmesi bekleniyor\n      20: {\n        label: \"Sertifika sahibi bordrolara yazılıyor. Lütfen, sayfayı terk etmeyiniz.\",\n        wait: true\n      },\n      // İmzala'ya basıldı -> 4.İmzalanıyor\n      30: {\n        label: \"Bordro dosyaları imzalanıyor. Lütfen, sayfayı terk etmeyiniz.\",\n      },\n      // İmzalanamadı ise;\n      40: {\n        label: \"Bordrolar imzalanamadı. Bilgileri kontrol ediniz.\",\n        danger: true\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.axios = Axios.create({\n      baseURL: \"http://127.0.0.1:9999\"\n    });\n\n    if (!this.props || !this.props.location || !this.props.location.bordroSession)\n      this.props.history.push({pathname: `/${this.props.peykName}/bordrosessionlist`});\n    else {\n      this.setState({selectedBordroIdList: this.props.location.selectedBordroIdList});\n      let monthNames = [\"Ocak\", \"Şubat\", \"Mart\", \"Nisan\", \"Mayıs\", \"Haziran\", \"Temmuz\", \"Ağustos\", \"Eylül\", \"Ekim\", \"Kasım\", \"Aralık\"];\n      let yearInput = moment(this.props.location.bordroSession.term, 'YYYY/MM/DD').format('YYYY');\n      let monthInput = moment(this.props.location.bordroSession.term, 'YYYY/MM/DD').format('M');\n      this.setState({mimeTitle: `${monthNames[monthInput - 1]} ${yearInput} Ücret Pusulası Bildirimi`});\n      this.setState({\n        mimeBody: \"4857 Sayılı İş Kanunu 37. ve 109. maddeleri hükmünce işveren tarafından hazırlanan \" +\n          monthNames[monthInput - 1] + \" \" + yearInput +\n          \" dönemine ilişkin ücret pusulası tarafınıza tebliğ edilmiştir.\"\n      });\n      this.readSmsTemplate();\n      this.readMailTemplate();\n    }\n  }\n\n  readSmsTemplate = () => {\n    let self = this;\n    let params = {\n      url: `/signer/readBordroSmsTemplateInfo`,\n      method: \"get\"\n    };\n    requestK(params)\n      .then(function (response) {\n        self.setState({smsBody: response.data})\n      }).catch(function (error) {\n      showAxiosError(error);\n    });\n  };\n\n  readMailTemplate = () => {\n    let self = this;\n    let params = {\n      url: `/signer/readBordroMailTemplateInfo`,\n      method: \"get\"\n    };\n    requestK(params)\n      .then(function (response) {\n        if (response.data) {\n          self.setState({mimeBody: response.data})\n        }\n      }).catch(function (error) {\n      showAxiosError(error);\n    });\n  };\n\n  componentDidUpdate() {\n    if (this.state.timer === 1 && !this.state.timerStarted &&\n        this.state.completed && this.state.signedDocumentCount === this.state.progressLength) {\n      setInterval(() => {\n        this.setState(prevState => ({timer: prevState.timer - 1}))\n      }, 1000);\n      this.setState({timerStarted: true});\n    } else if (this.state.timer === 0) {\n      this.props.history.push({\n        pathname: `/${this.props.peykName}/bordroimport/` + this.props.location.bordroSession.id,\n        from: \"sign\",\n        signed: this.state.signedDocumentCount,\n        unsigned: (this.state.selectedBordroIdList.length - this.state.signedDocumentCount)\n      });\n    }\n  }\n\n  isNoTemplateValid = () => {\n    if (this.state.mimeTitle.trim() === \"\") {\n      Alert.error(\"E-Posta İleti Konusu alanı boş bırakılamaz.\", {\n        position: 'top-right',\n        effect: 'stackslide',\n        timeout: 5000\n      });\n      this.setState({alert: null});\n      return false;\n    } else if (this.state.mimeBody.trim() === \"\") {\n      Alert.error(\"E-Posta İleti İçeriği alanı boş bırakılamaz.\", {\n        position: 'top-right',\n        effect: 'stackslide',\n        timeout: 5000\n      });\n      this.setState({alert: null});\n      return false;\n    } else if (this.state.smsBody.trim() === \"\") {\n      Alert.error(\"SMS İleti İçeriği alanı boş bırakılamaz.\", {\n        position: 'top-right',\n        effect: 'stackslide',\n        timeout: 5000\n      });\n      this.setState({alert: null});\n      return false;\n    }else{\n      return true;\n    }\n  }\n\n  updateMailInfo() {\n    let self = this;\n    let selectedBordroIdList = self.state.selectedBordroIdList ? self.state.selectedBordroIdList : self.props.location.selectedBordroIdList;\n    let params = {\n      url: `/signer/writeMailInfo`,\n      method: \"post\",\n      data: {\n        bordroSessionId: self.props.location.bordroSession.id,\n        title: self.state.mimeTitle,\n        body: self.state.mimeBody,\n        smsBody: self.state.smsBody,\n        selectedBordros: selectedBordroIdList\n      }\n    };\n    self.setState({selectedBordroIdList, pageState: 10, alert: null, disableButton: true});\n    requestK(params)\n      .then(function (response) {\n        self.updatePdfCertificates();\n      }).catch(function (error) {\n      showAxiosError(error);\n      self.setState({pageState: 40, disableButton: false});\n    });\n  }\n\n  timerStatus(status){\n    this.props.onTimerStatus(status);\n  };\n  updatePdfCertificates() {\n    let self = this;\n    let bordroSessionId = self.props.location.bordroSession.id;\n    let hsmType = self.state.pdfCertificate.hsmType;\n    let certificate = self.state.pdfCertificate.value;\n    let certificateKeyId = self.state.pdfCertificate.keyId;\n    let pdfCertificate = JSON.stringify(self.state.pdfCertificate);\n    let params = {\n      url: `/signer/createPdfSignedInfoList`,\n      method: \"post\",\n      data: {\n        bordroSessionId: bordroSessionId,\n        hsmType: hsmType,\n        certificate: certificate,\n        certificateKeyId: certificateKeyId,\n        bordroIdList: self.state.selectedBordroIdList,\n        pdfCertificate: pdfCertificate,\n      },\n      timeout: 9600000\n    };\n    self.setState({pageState: 20, alert: null});\n    this.timerStatus(true);\n    requestK(params)\n        .then((response) => {\n          self.setState({ signedInfoList: response.data });\n          self.signBordros();\n        })\n        .catch((error) => {\n          showAxiosError(error);\n          self.setState({ pageState: 40, disableButton: false });\n          this.timerStatus(false);\n        });\n  }\n\n  async signBordros() {\n    let signedBordro = [];\n    this.setState({\n      progressLength: this.state.signedInfoList.length,\n      loading: true,\n      pageState: 30\n    });\n    try {\n      for (const element of this.state.signedInfoList) {\n        this.setState({ pdfName: element.pdfName });\n        const response = await this.axios.post(\"/signature/signedinfo?hsmtype=\" + element.hsmType, {\n          base64: true,\n          pin: this.state.pin,\n          signedInfo: element.signedInfo,\n          certificate: {\n            keyId: element.certificateKeyId\n          }\n        });\n        signedBordro.push({\n          id: element.id,\n          signature: response.data.signedDocument\n        });\n        await this.writeSignedBordro(signedBordro);\n        signedBordro = [];\n        this.setState({\n          loading: false,\n          completed: true\n        });\n        this.timerStatus(false);\n      }\n    } catch (error) {\n      if (error.response && error.response.status === 401) {\n        this.setState({\n          alert: (\n              <SweetAlert info\n                          confirmBtnText=\"Tamam\"\n                          confirmBtnBsStyle=\"warning\"\n                          title=\"UYARI\"\n                          onConfirm={() => {\n                            this.setState({alert: null});\n                            window.location = \"/accounting/login\";\n                          }}\n              >\n                Peyk sunucularına erişim esnasindaki bir hatadan dolayi İmza süreci tamamlanamadi. Lütfen tekrar login olup kalan imzalama islemine devam ediniz.\n              </SweetAlert>\n          )\n        });\n        return;\n      } else {\n        this.setState({\n          loading: false,\n          completed: false,\n          pageState: 0,\n          disableButton: false,\n          alert: <HsmErrorAlert error={error} onConfirm={() => this.setState({alert: null})}/>\n        });\n        this.timerStatus(false);\n      }\n    }\n  }\n\n  async writeSignedBordro(signedBordro) {\n    try {\n      let params = {\n        url: `/signer/writePdfSignature`,\n        method: \"post\",\n        data: signedBordro,\n        timeout: 9600000\n      };\n      await requestK(params);\n      this.setState((prevState) => ({\n        signedDocumentCount: prevState.signedDocumentCount + 1\n      }));\n    } catch (error) {\n      if (error.response && error.response.status === 401) {\n        throw error;\n      } else {\n        showAxiosError(error);\n        this.setState({ pageState: 40 });\n        this.timerStatus(false);\n      }\n    }\n  }\n\n  renderNavButtons() {\n    return (\n      <Nav className=\"topbar\" style={{paddingLeft: '14px', height: '53px'}}>\n        <StickButton position=\"leftSide\" className=\"zocial GeriDon\" style={{fontSize: 'x-small'}}\n                     label=\"Geri\" title=\"Önceki Sayfaya Git\"\n                     onClick={e => this.props.history.push({\n                       pathname: `/${this.props.peykName}/bordroimport/` + this.props.location.bordroSession.id,\n                       selectedBordroIdList: this.props.location.selectedBordroIdList\n                     })}/>\n        <StickButton position=\"leftSide\" className=\"zocial Imza\" style={{fontSize: 'x-small'}}\n                     label=\"İmzala\" title=\"Ücret Bordrolarını İmzala\"\n                     disabled={this.state.disableButton || !this.state.pin}\n                     onClick={e => {\n                       if (this.state.pdfCertificate && this.state.pdfCertificate.hsmType &&\n                         this.state.pdfCertificate.value && this.state.pdfCertificate.keyId)\n                         this.setState({\n                           alert: (\n                             <SweetAlert showCancel warning\n                                         confirmBtnText=\"Evet\"\n                                         cancelBtnText=\"Hayır\"\n                                         confirmBtnBsStyle=\"success\"\n                                         cancelBtnBsStyle=\"default\"\n                                         title=\"Emin misiniz?\"\n                                         onConfirm={() => {\n                                           if(this.isNoTemplateValid()){\n                                             this.updateMailInfo();\n                                           }\n                                         }}\n                                         onCancel={() => this.setState({alert: null})}\n                             >\n                               Dokümanlar imzalanıp Tübitak zaman damgası ile mühürlenerek gönderilecektir.\n                             </SweetAlert>\n                           )\n                         });\n                       else\n                         this.setState({\n                           alert: <HsmErrorAlert error={this.state.certError}\n                                                 onConfirm={() => this.setState({alert: null})}/>\n                         });\n                     }}/>\n      </Nav>\n    );\n  }\n\n  renderState() {\n    let stateMap = this.stateMap[this.state.pageState];\n\n    return <div className=\"row\" style={{marginBottom: \"15px\"}}>\n      <Col sm='12' md='6'>\n        <div style={{display: \"inline-block\", marginRight: \"8px\"}}>\n          {stateMap.wait && <ReactLoading type=\"balls\" color=\"#2c2c2c\" height={24} width={24}/>}\n        </div>\n        <div style={{\n          display: \"inline-block\", marginRight: \"8px\", position: \"relative\", top: \"-6px\",\n          color: stateMap.danger === true ? \"trueColor\" : \"falseColor\"\n        }}>\n          {stateMap.label}\n        </div>\n      </Col>\n      <Col sm='12' md='6'>\n        <div className='explanationOfSigning' style={{lineHeight: '1.2'}}>\n          <i className=\"fas fa-exclamation-triangle\" id=\"exclamationIcon\" style={{paddingRight: '10px'}}/>\n          <span style={{opacity: '0.9', fontSize: '12px', fontWeight: '500'}}>İmzalama süresince lütfen ekranı kapatmayınız ve bilgisayarınızın ekran koruyucusunun kapalı olduğundan emin olun.</span>\n        </div>\n      </Col>\n    </div>\n  }\n\n  renderMailInputs() {\n\n    return <div className=\"FormRenk\">\n      <Row sm={6}>\n        <Col sm={2} style={{top: '5px'}}>\n          E-Posta Konu\n        </Col>\n        <Col sm={6}>\n          <Input type=\"text\" style={{marginTop: '2px'}}\n                 value={this.state.mimeTitle}\n                 onChange={(e) => this.setState({mimeTitle: e.target.value})}/>\n        </Col>\n      </Row>\n      <Row sm={6}>\n        <Col sm={2} style={{top: '25px'}}>\n          E-Posta İçerik\n        </Col>\n        <Col sm={6}>\n          <Input type=\"textarea\" rows={5}\n                 style={{\n                   height: '200px',\n                   border: '1px solid #E3E3E3',\n                   marginTop: '2px',\n                   padding: '3px 3px'\n                 }}\n                 value={this.state.mimeBody}\n                 onChange={(e) => this.setState({mimeBody: e.target.value})}/>\n        </Col>\n      </Row>\n      <Row sm={6}>\n        <Col sm={2} style={{top: '25px'}}>\n          SMS İçerik\n        </Col>\n        <Col sm={6}>\n          <Input type=\"textarea\" rows={5}\n                 style={{\n                   height: '200px',\n                   border: '1px solid #E3E3E3',\n                   marginTop: '2px',\n                   padding: '3px 3px'\n                 }}\n                 value={this.state.smsBody}\n                 onChange={(e) => this.setState({smsBody: e.target.value})}/>\n        </Col>\n      </Row>\n    </div>\n  }\n\n  renderBordroList() {\n    return <BordroTableIdSelected bordroSession={this.props.location.bordroSession}\n                                  selectedBordroIdList={this.props.location.selectedBordroIdList}\n                                  onComplete={e => this.setState({selectedBordroIdList: e})}\n                                  pageSize={10} history={this.props.history} peykName={this.props.peykName}\n                                  processCode={ProcessCode.SIGNBORDRO.code}\n                                  toggleModal={(flag) => this.setState({disableButton: flag})}/>\n  }\n\n  render() {\n    return (\n      <Row className=\"baseBackground\">\n        <Notify ref=\"notify\"/>\n        {this.state.alert}\n        {this.renderNavButtons()}\n        <div className=\"row satirBasi\">\n          <Col md=\"12\">\n            <Card className=\"card\">\n              <CardHeader>\n                <CardTitle tag=\"h4\">\n                  İmzala & Gönder\n                </CardTitle>\n              </CardHeader>\n              <CardBody style={{position: 'relative'}}>\n                {this.props.location.bordroSession && this.renderState()}\n              </CardBody>\n\n              <CardBody>\n                {this.props.location.bordroSession && this.renderMailInputs()}\n              </CardBody>\n              <CardBody>\n                {this.props.location.bordroSession &&\n                <HsmCertificateViewer sessionId={this.props.location.bordroSession.id}\n                                      value={this.state.pdfCertificate}\n                                      onChange={(val) => this.setState({pdfCertificate: val})}\n                                      pinValueChange={(val) => this.setState({pin: val})}\n                                      certificateError={(val) => this.setState({certError: val})}\n                                      pdfName={this.state.bordroName ? this.state.bordroName : \"\"}\n                                      progressLength={this.state.progressLength}\n                                      signedDocumentCount={this.state.signedDocumentCount}\n                                      displayCertificateMenu={this.state.pageState === 0 || this.state.pageState === 40}\n                                      userId={this.props.currentUser && this.props.currentUser.id}/>}\n              </CardBody>\n              <CardBody>\n                {this.props.location.bordroSession && this.renderBordroList()}\n              </CardBody>\n            </Card>\n          </Col>\n        </div>\n      </Row>\n\n    );\n  }\n\n}\n\nexport default SignBordroMailPage;\n"],"sourceRoot":""}