(this["webpackJsonpportal-react"]=this["webpackJsonpportal-react"]||[]).push([[29],{1414:function(e,t,a){"use strict";var l=a(0),s=a.n(l),n=a(2),o=a(5),i=a(3),r=a(6),c=a.n(r),d=a(262),h=a(1378),p=a.n(h),m=a(12);class u extends l.Component{constructor(e){super(e),this.onSelectionChange=(e,t)=>{let a=this.state.selectedData,l=t.target.checked;a[e.key]=l;let s=Object(m.L)(this.props.treeData[0],e.key);s&&s.map(e=>a[e]=l),this.setState({selectedData:a}),this.props.onSelect(a)},this.state={selectedData:this.props.selectedData?this.props.selectedData:{}}}render(){let e=this.state.maxLength?this.state.maxLength:0;const t=(e,l)=>e&&e.length?e.map(e=>s.a.createElement(p.a,{key:e.key,title:a(e,l)},t(e.children,l-18))):null,a=(e,t)=>s.a.createElement("div",{style:{display:"inline-flex"}},s.a.createElement(n.Col,{xs:"10",style:{margin:"0",padding:"0",width:t+"px"},title:e.title},s.a.createElement("label",null," ",e.title,s.a.createElement("input",{type:"checkbox",style:{width:"40px"},checked:this.state.selectedData&&this.state.selectedData[e.key],onChange:t=>this.onSelectionChange(e,t)}))));return s.a.createElement("div",{className:"col-xl-auto"},s.a.createElement(d.a,{showLine:!0,icon:e=>{let{}=e;return s.a.createElement("i",{className:"fa fa-university"})},selectable:!1,defaultExpandedKeys:[this.props.treeData[0].key]},t(this.props.treeData,e)))}}var g=u,y=a(85);class b extends l.Component{constructor(e){super(e),this.getExistingAuthority=()=>{let e=this,t={url:"employee/getExistingAuthority",method:"post",data:e.props.id};Object(o.e)(t).then((function(t){let a=t.data,l={};a&&a.length&&a.map(e=>{l[e.toString()]=!0}),e.setState({selectedData:l},()=>e.getData())})).catch((function(e){Object(i.v)(e)}))},this.getData=()=>{let e=this,t={url:"department/readDepartmentTreeData",method:"post",data:e.props.selectedAuthorizationWay};Object(o.e)(t).then((function(t){t.data?e.setState({treeData:t.data}):c.a.error("Yetki verilecek birimler olu\u015fturulmam\u0131\u015f.",{position:"top-right",effect:"stackslide",timeout:5e3})})).catch((function(e){Object(i.v)(e)}))},this.saveClicked=()=>{let e=this;if(e.state.selectedData){let t={url:"employee/saveOrganizationAuthority",method:"post",data:{employeeId:e.props.id,selectedList:e.readSelectedDeptIdList()}};Object(o.e)(t).then((function(){c.a.success(e.props.selectedAuthorizationWay===i.c.DEPARTMENT?"Organizasyonel birimlere yetki kaydedildi.":"Masraf Yeri yetkisi kaydedildi.",{position:"top-right",effect:"stackslide",timeout:5e3}),e.props.toggleModal(!1,!0)})).catch((function(e){Object(i.v)(e)}))}else c.a.error("Birim se\xe7ilmedi.",{position:"top-right",effect:"stackslide",timeout:3e3})},this.readSelectedDeptIdList=()=>{let e=[];return Object.keys(this.state.selectedData).map(t=>{this.state.selectedData[t]&&e.push(t)}),e},this.state={btnDisabled:!1,manual:!1,employee:{},treeData:[],selectedData:{},existingAuthority:[],shouldRun:!0,steps:[{target:".card-title",content:"Bu Ekranda se\xe7ti\u011finiz \xe7al\u0131\u015fana organizasyonel yetki verebilirsiniz.",placement:"center"},{target:"table tbody tr:nth-child(1) td:nth-child(1) input",content:"\xc7al\u0131\u015fana verilmi\u015f organizasyonel yetkileri buradan kontrol edebilirsiniz.",placement:"auto"},{target:"table tbody tr:nth-child(1) td:nth-child(1) input",content:"Yetki vermek istedi\u011finiz organizasyon birimlerini se\xe7iniz.",placement:"auto"},{target:".kaydet",content:"Kaydet",placement:"auto"}],locale:{back:"Geri",close:"Kapat",last:"Son",next:"\u0130leri",skip:"Atla"}}}componentDidMount(){let e=this,t={url:"/employee/getEmployeeById",method:"post",data:e.props.id?e.props.id:-1};Object(o.e)(t).then((function(t){!t.data.id&&e.props.tckn&&(t.data.tckn=e.props.tckn),e.setState({employee:t.data,manager:t.data.manager,department:b.getDepartmentElement(t.data)})})).catch((function(e){Object(i.v)(e)})),e.getExistingAuthority()}static getDepartmentElement(e){return e.department?{value:e.department.id.toString(),label:e.department.name}:null}renderInput(e,t){return s.a.createElement(n.FormGroup,{row:!0},s.a.createElement(n.Label,{sm:4},e),s.a.createElement(n.Col,{sm:8},s.a.createElement(n.Input,{type:"text",name:t,value:this.state.employee[t]||""})))}render(){return s.a.createElement(y.a,{disabled:this.state.btnDisabled,isOpen:this.props.modal,size:"lg",closeOnEsc:!1,id:"title",title:this.props.selectedAuthorizationWay===i.c.DEPARTMENT?"Organizasyonel Yetki Atama":"Masraf Yeri Yetki Atama",confirmBtnText:"Kaydet",cancelBtnText:"Kapat",onConfirm:this.saveClicked,onCancel:()=>this.props.toggleModal(!1,!1)},s.a.createElement("div",{style:{marginTop:"20px"}},s.a.createElement(n.Form,null,s.a.createElement("div",{className:"FormRenk",style:{marginBottom:"10px",paddingLeft:"20px",paddingRight:"20px"}},s.a.createElement("label",{style:{fontWeight:"bold",display:"block"}},"Yekti Verilen \xc7al\u0131\u015fan"),s.a.createElement(n.Col,{sm:8},this.renderInput("Ad","name"),this.renderInput("Soyad","surname"),this.renderInput("TCKN","tckn"))),s.a.createElement("div",{className:"FormRenk",style:{paddingLeft:"20px",paddingRight:"20px",overflowY:"scroll",flex:"1",maxHeight:"450px"}},s.a.createElement("label",{style:{fontWeight:"bold",display:"block"}},"Se\xe7im Ekran\u0131:"),this.state.treeData&&this.state.treeData.length>0&&s.a.createElement(g,{treeData:this.state.treeData,selectedData:this.state.selectedData,onSelect:e=>this.setState({selectedData:e,manual:!0})})),this.state.alert)))}}t.a=b},1579:function(e,t,a){"use strict";a.r(t);var l=a(0),s=a.n(l),n=a(19),o=a(2),i=a(62),r=a(5),c=a(23),d=a(64),h=a(13),p=a.n(h),m=a(20),u=a.n(m),g=a(3),y=a(1414),b=a(63),E=a.n(b);class R extends l.Component{constructor(e){super(e),this.getDepartmentsAndExpenditureDeps=()=>{let e=this;Object(r.e)({url:"/employee/getList",method:"get"}).then((function(t){let{departmentList:a,expenditureDepList:l}=t.data;e.setState({departmentList:a,expenditureDepList:l})})).catch((function(e){Object(g.v)(e)}))},this.handleRoleSelect=e=>{this.setState({selectedRole:e})},this.handleSearch=e=>{this.setState({searchQuery:e,searching:!0,selectedPersonal:void 0,selectedRowNum:-1},()=>this.fetchData(this.state.accessor,this.state.direction,0,this.state.size))},this.state={loading:!1,content:[],contentRoleTable:[],total:0,page:0,size:10,totalIdList:[],manual:!1,searching:!1,searchQuery:void 0,selectedPersonal:void 0,showAuthorityModal:!1,selectedRole:null,roleList:[],isRolesLoading:!1,selectedRowNum:-1,approveAlert:null,displayAddRoleToPersonelDialog:!1,authorizationWay:g.c.DEPARTMENT,departmentList:[],expenditureDepList:[]},this.fetchData=this.fetchData.bind(this),this.handleSearch=this.handleSearch.bind(this),this.onClickPersonalTable=this.onClickPersonalTable.bind(this),this.getRoleList=this.getRoleList.bind(this),this.handleRoleSelect=this.handleRoleSelect.bind(this),this.getPersonalRoleList=this.getPersonalRoleList.bind(this),this.deletePersonalRole=this.deletePersonalRole.bind(this),this.deletePersonalRoleControl=this.deletePersonalRoleControl.bind(this),this.addToRoleToPersonalControl=this.addToRoleToPersonalControl.bind(this),this.addToRoleToPersonal=this.addToRoleToPersonal.bind(this),this.getDepartmentsAndExpenditureDeps=this.getDepartmentsAndExpenditureDeps.bind(this)}componentDidMount(){this.getRoleList(),this.getDepartmentsAndExpenditureDeps()}onClickPersonalTable(e,t,a){this.setState({selectedPersonal:t,selectedRowNum:a}),this.getPersonalRoleList(t)}addToRoleToPersonalControl(){let e=this;null!==e.state.selectedRole?0===e.state.contentRoleTable.filter(t=>t.id===e.state.selectedRole.value).length?e.setState({approveAlert:s.a.createElement(p.a,{showCancel:!0,warning:!0,confirmBtnText:"Evet",cancelBtnText:"Hay\u0131r",confirmBtnBsStyle:"danger",cancelBtnBsStyle:"default",title:"",onConfirm:()=>e.addToRoleToPersonal(),onCancel:()=>e.setState({approveAlert:null})},"Se\xe7ilen personele "+e.state.selectedRole.label+" rol\xfc verilecektir. Onayl\u0131yor musunuz?")}):u()({title:"Uyar\u0131 ! ",text:"Bu rol daha \xf6nce verilmi\u015f!. L\xfctfen farkl\u0131 bir rol se\xe7iniz.",type:"warn",confirmButtonText:"Tamam"}).then(()=>{}):u()({title:"Uyar\u0131 ! ",text:"L\xfctfen eklemek istedi\u011finiz rol\xfc se\xe7iniz!",type:"warn",confirmButtonText:"Tamam"}).then(()=>{})}addToRoleToPersonal(){let e=this,t={url:"/role/addRoleToPersonal",method:"post",data:{employeeUserId:e.state.selectedPersonal.employeeUserId,roleId:this.state.selectedRole.value}};e.setState({approveAlert:null}),Object(r.e)(t).then((function(t){e.setState({contentRoleTable:t.data}),u()({title:"Ba\u015far\u0131l\u0131 ! ",text:"Rol ba\u015far\u0131l\u0131 bir\u015fekilde verilmi\u015ftir.",type:"success",confirmButtonText:"Tamam"}).then(()=>{})})).catch((function(e){Object(g.v)(e)}))}deletePersonalRoleControl(e){this.setState({approveAlert:s.a.createElement(p.a,{showCancel:!0,warning:!0,confirmBtnText:"Evet",cancelBtnText:"Hay\u0131r",confirmBtnBsStyle:"danger",cancelBtnBsStyle:"default",title:"",onConfirm:()=>this.deletePersonalRole(e),onCancel:()=>this.setState({approveAlert:null})},"Se\xe7ilen personelden "+e.roleName+" rol\xfc kald\u0131r\u0131lacakt\u0131r. Onayl\u0131yor musunuz?")})}deletePersonalRole(e){let t=this,a={url:"/role/deletePersonalRole",method:"post",data:{employeeUserId:t.state.selectedPersonal.employeeUserId,roleId:e.id}};t.setState({approveAlert:null}),Object(r.e)(a).then((function(e){t.setState({contentRoleTable:e.data}),u()({title:"Ba\u015far\u0131l\u0131 ! ",text:"Rol ba\u015far\u0131l\u0131 bir\u015fekilde kald\u0131r\u0131lm\u0131\u015ft\u0131r.",type:"success",confirmButtonText:"Tamam"}).then(()=>{})})).catch((function(e){Object(g.v)(e)}))}getRoleList(){let e=this;e.setState({isRolesLoading:!0}),Object(r.e)({url:"/role/getRoleList",method:"get"}).then((function(t){e.setState({isRolesLoading:!1});let a=[];t.data.map(e=>{a.push({value:e.id,label:e.roleName,role:e})}),e.setState({roleList:a})})).catch((function(t){e.setState({isRolesLoading:!1}),Object(g.v)(t)}))}getPersonalRoleList(e){let t=this,a={url:"/role/personalRoleList",method:"post",data:e.employeeUserId};t.setState({isRolesLoading:!0}),Object(r.e)(a).then((function(e){t.setState({contentRoleTable:e.data,isRolesLoading:!1})})).catch((function(e){t.setState({isRolesLoading:!1}),Object(g.v)(e)}))}fetchData(e,t,a,l){let s=this,n=void 0!==e?"&sort="+e+","+t:"&sort=id,desc",o=s.state.searchQuery?"&"+s.state.searchQuery:"",i={url:"/role/personalList?page="+a+"&size="+l+(""!==o&&o.includes("depId")?"":"&depId=")+(""!==o&&o.includes("expDepId")?"":"&expDepId=")+(""!==o&&o.includes("roleId")?"":"&roleId=")+o+n,method:"get"};s.setState({loading:!0,searching:!0,manual:!0!==s.manual&&s.manual}),Object(r.e)(i).then((function(e){s.setState({page:a,size:l,total:e.data&&e.data.totalElements?e.data.totalElements:0,content:e.data?e.data.content:[],loading:!1,searching:!1})})).catch((function(e){s.setState({loading:!1,searching:!1}),Object(g.v)(e)}))}renderAddRole(){const e=[{Header:"Rol\xfcn Ad\u0131",accessor:"roleName",sortable:!1,width:"85%"},{Header:"\u0130\u015flemler",accessor:"",sortable:!1,width:"15%",Cell:e=>s.a.createElement("div",null,s.a.createElement(d.a,{title:"Sil",faIcon:"fa-trash",color:"danger",onClick:()=>this.deletePersonalRoleControl(e)}))}];return s.a.createElement(o.Modal,{isOpen:this.state.displayAddRoleToPersonelDialog,size:"lg",toggle:()=>this.setState({displayAddRoleToPersonelDialog:!1})},s.a.createElement(o.ModalHeader,{className:"justify-content-center",toggle:()=>this.setState({displayAddRoleToPersonelDialog:!1})}," Personel Rol Atama"),s.a.createElement(o.ModalBody,null,this.state.displayAddRoleToPersonelDialog&&s.a.createElement(E.a,{ref:this.notify}),s.a.createElement("div",null,s.a.createElement("div",{className:"card-body",style:{padding:"16px"}},s.a.createElement(o.Form,null,s.a.createElement(o.FormGroup,{row:!0},s.a.createElement(o.Col,{sm:2},s.a.createElement("label",{style:{marginTop:0}},"Rol Se\xe7:")),s.a.createElement(o.Col,{sm:8},s.a.createElement(c.a,{value:null!==this.state.selectedRole?this.state.selectedRole.value:-1,clearable:!1,noResultsText:"Rol bulunamad\u0131",clearValueText:"Temizle",placeholder:"Personele Atamak \u0130\xe7in Rol Se\xe7iniz...",onChange:this.handleRoleSelect,options:this.state.roleList,style:{marginTop:0}})),s.a.createElement(o.Col,{sm:2},s.a.createElement(o.Button,{className:"btn btn-info",style:{paddingLeft:"16px",marginTop:0},onClick:this.addToRoleToPersonalControl,disabled:!this.state.selectedPersonal},"Ekle"))))),s.a.createElement("div",{className:"card-body"},s.a.createElement("label",{style:{textAlign:"center",fontWeight:"bold",fontSize:"16px"}},void 0!==this.state.selectedPersonal?" "+this.state.selectedPersonal.name.toUpperCase()+" "+this.state.selectedPersonal.surname.toUpperCase()+" ":" ","Adl\u0131 Personelin Rolleri"),s.a.createElement(n.a,{loading:this.state.isRolesLoading,loadingText:"Kay\u0131tlar getiriliyor...",emptyMessage:"Rol Bulunamad\u0131",columns:e,content:this.state.contentRoleTable?this.state.contentRoleTable:[],paginationEnabled:!1})))),s.a.createElement(o.ModalFooter,null))}render(){const e=[{label:"Ad\u0131",accessor:"name",type:"text",operator:"="},{label:"Soyad\u0131",accessor:"surname",type:"text",operator:"="},{label:"TCKN",accessor:"tckn",type:"numericText",operator:"="},{label:"Rol",accessor:"roleId",type:"select",operator:"=",selectData:this.state.roleList},{label:"Yetkili Oldu\u011fu Departman Listesi ",accessor:"depId",type:"select",operator:"=",selectData:this.state.departmentList},{label:"Yetkili Oldu\u011fu Masraf Yeri Listesi ",accessor:"expDepId",type:"select",operator:"=",selectData:this.state.expenditureDepList}],t=[{Header:"Ad\u0131",accessor:"name",width:"25%"},{Header:"Soyad\u0131",accessor:"surname",width:"25%"},{Header:"TCKN",accessor:"tckn",width:"25%"},{Header:"\u0130\u015flemler",accessor:"",sortable:!1,width:"10%",Cell:(e,t)=>s.a.createElement("div",null,s.a.createElement(d.a,{title:"Personele Rol Ekle",faIcon:"fa-plus",onClick:a=>{this.setState({displayAddRoleToPersonelDialog:!0},()=>this.onClickPersonalTable(a,e,t))},color:"success"}),s.a.createElement(d.a,{title:"Organizasyonel Yetki Ata",faIcon:"fa-sort-amount-asc",onClick:()=>this.setState({authorizationWay:g.c.DEPARTMENT,showAuthorityModal:!0,selectedPersonal:e}),color:"info"}),s.a.createElement(d.a,{title:"Masraf Yeri Yetki Ata",faIcon:"fa-sort-amount-asc",onClick:()=>this.setState({authorizationWay:g.c.EXPENDITURE,showAuthorityModal:!0,selectedPersonal:e}),color:"primary"}))}];return s.a.createElement("div",{className:"row baseBackground"},this.state.approveAlert,s.a.createElement(o.Nav,{className:"topbar",style:{paddingLeft:"14px",height:"53px"}}),s.a.createElement("div",{className:"col-sm-12 satirBasi"},s.a.createElement("div",{className:"card-header"},s.a.createElement("h4",{className:"card-title"},"Personel Listesi")),s.a.createElement("div",{className:"card-body"},s.a.createElement(i.a,{fields:e,loading:this.state.searching,onSearch:this.handleSearch})),s.a.createElement("div",{className:"card-body"},s.a.createElement(n.a,{loading:this.state.loading,loadingText:"Kay\u0131tlar getiriliyor...",columns:t,content:this.state.content?this.state.content:[],total:this.state.total?this.state.total:0,page:this.state.page?this.state.page:0,size:this.state.size?this.state.size:0,options:["5","10","20","50","100"],fetchData:this.fetchData,manual:this.state.manual})),this.renderAddRole()),this.state.showAuthorityModal&&s.a.createElement(y.a,{id:this.state.selectedPersonal.id,modal:this.state.showAuthorityModal,selectedAuthorizationWay:this.state.authorizationWay,toggleModal:(e,t)=>this.setState({showAuthorityModal:e,manual:t})}))}}t.default=R}}]);