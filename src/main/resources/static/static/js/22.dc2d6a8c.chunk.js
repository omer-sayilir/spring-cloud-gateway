(this["webpackJsonpportal-react"]=this["webpackJsonpportal-react"]||[]).push([[22],{1300:function(e,t,a){"use strict";t.a={SIGNBORDRO:{code:0},SIGNMIME:{code:1},RESENDMIME:{code:2}}},1313:function(e,t,a){"use strict";var s=a(0),o=a.n(s),r=a(19),n=a(13),i=a.n(n),l=(a(220),a(9)),d=a.n(l),c=(a(83),a(6)),m=a.n(c),p=a(1300),h=a(3),u=a(5),g=a(12),y=a(46),E=a(75);class b extends s.Component{constructor(e){super(e),this.getEmployeeId=async()=>{let e=this,t=this.state.content[0].employee.id,a={url:"/employee/getEmployeeId/".concat(t),method:"post"};try{let t=await Object(u.e)(a);e.setState({employeeUserId:t.data})}catch(s){Object(h.v)(s),e.setState({loading:!1})}},this.getApprovalUserId=async()=>{let e=this,t=this.state.content[0].id,a={url:"/approval/getApprovalUserId/".concat(t),method:"post"};try{let t=await Object(u.e)(a);e.setState({approvalUserId:t.data})}catch(s){Object(h.v)(s),e.setState({loading:!1})}},this.state={loading:!1,alert:null,selection:[],manual:!1,content:[],total:0,page:0,size:10},this.fetchData=this.fetchData.bind(this),this.previewBordro=this.previewBordro.bind(this),this.setMediaViewer=this.setMediaViewer.bind(this)}fetchData(e,t,a,s){let r=this,n=void 0!==e?"&sort="+e+","+t:"",l={url:"/bordro/readBordroAllByIds?processCode="+r.props.processCode+"&page="+a+"&size="+s+n,method:"post",data:r.props.selectedBordroIdList};r.setState({loading:!0,searching:!0,manual:!0!==r.manual&&r.manual}),Object(u.e)(l).then((async function(e){let t=r.props.bordroSession&&r.props.bordroSession.id;if(e.data.page&&0===e.data.page.totalElements)r.setState({alert:o.a.createElement(i.a,{error:!0,confirmBtnText:"Tamam",confirmBtnBsStyle:"danger",title:"Hata",onConfirm:()=>{t?r.props.history.push({pathname:"/".concat(r.props.peykName,"/bordroimport/")+t}):r.setState({alert:null}),r.props.toggleModal&&r.props.toggleModal(!0)}},r.props.processCode===p.a.RESENDMIME.code&&"Se\xe7ilen al\u0131c\u0131lar\u0131n onayda bekleyen g\xf6nderileri bulunmamaktad\u0131r.",r.props.processCode===p.a.SIGNBORDRO.code&&"Se\xe7ilen \xfccret bordrolar\u0131n\u0131n imzal\u0131 iletiler bulundu\u011fu veya \xe7al\u0131\u015fan e\u015fle\u015fmesi yap\u0131lmam\u0131\u015f oldu\u011fu i\xe7in bu i\u015flem yap\u0131lamaz.",r.props.processCode===p.a.SIGNMIME.code&&"Se\xe7ilen \xfccret bordrolar\u0131n\u0131n imzal\u0131 iletiler bulundu\u011fu veya \xe7al\u0131\u015fan e\u015fle\u015fmesi yap\u0131lmam\u0131\u015f oldu\u011fu i\xe7in bu i\u015flem yap\u0131lamaz."),loading:!1});else{if(e.data.page&&e.data.page.totalElements<r.props.selectedBordroIdList.length){r.props.toggleModal(!1);let e=r.props.processCode===p.a.RESENDMIME.code?"Tekrar g\xf6nderime haz\u0131r bordrolar se\xe7ilmi\u015ftir.":(r.props.processCode,p.a.SIGNBORDRO.code,"\xc7al\u0131\u015fan e\u015fle\u015fmesi olmayanlar ve daha \xf6nce g\xf6nderilmi\u015f bordro listeden \xe7\u0131kar\u0131lm\u0131\u015ft\u0131r.");m.a.warning(e,{position:"top-right",effect:"stackslide",timeout:8e3})}r.setState({page:a,size:s,total:e.data.page&&e.data.page.totalElements,content:e.data.page&&e.data.page.content,loading:!1},()=>{"FLOW_TIMEOUT"===e.data.page.content[0].state&&r.props.updateFlowTimeout(!0),r.props.onComplete(e.data.selectedIdList)}),"FLOW_TIMEOUT"===e.data.page.content[0].state&&(await r.getEmployeeId(),await r.getApprovalUserId(),r.state.approvalUserId===r.state.employeeUserId?r.props.readFlowTimeoutTemplate():r.props.readTimeoutTemplate())}})).catch((function(e){r.setState({loading:!1}),Object(h.v)(e)}))}setMediaViewer(){this.setState({url:null,mediaModal:!1})}previewBordro(e){let t=this,a={url:"/bordro/previewBordroContent",responseType:"arraybuffer",method:"post",data:e.id};t.setState({mediaModal:!0}),Object(u.e)(a).then((function(e){let a=new Blob([e.data],{type:e.headers["content-type"]}),s="";if(void 0!=a){let e=new FileReader;e.readAsDataURL(a),e.onloadend=function(){s=e.result,t.setState({url:s})}}})).catch((function(e){Object(h.v)(e),t.setState({mediaModal:!1})}))}render(){let e=[{Header:"D\xf6nem",accessor:"term",Cell:e=>o.a.createElement("div",null,!!e.term&&d()(e.term,"YYYY/MM/DD").format("YYYY/MM"))},{Header:"TCKN",accessor:"parsedTckn",Cell:e=>o.a.createElement("div",null,e.employee&&e.employee.name&&o.a.createElement("span",{className:"text-success"},e.parsedTckn),!(e.employee&&e.employee.name)&&o.a.createElement("span",{className:"text-danger"},e.parsedTckn))},{Header:"Ad\u0131",accessor:"employee_name",Cell:e=>o.a.createElement("div",null,e.employee&&e.employee.name)},{Header:"Soyad\u0131",accessor:"employee_surname",Cell:e=>o.a.createElement("div",null,e.employee&&e.employee.surname)},{Header:"Kep Adresi",accessor:"employee_kepAddress",Cell:e=>o.a.createElement("div",null,e.employee&&e.employee.kepAddress)},{Header:"Uyar\u0131 Say\u0131s\u0131",accessor:"warningCount",Cell:e=>o.a.createElement("div",{style:{margin:0}},e.warningCount)},{Header:"Durumu",accessor:"state",Cell:e=>o.a.createElement("div",null,e.error&&o.a.createElement("span",{className:"text-danger"},e.error),!e.error&&o.a.createElement("span",{className:"text-"+y.a[e.state].messageType},y.a[e.state].message))},{Header:"\u0130\u015flemler",sortable:!1,accessor:"",Cell:e=>o.a.createElement("div",{style:{textAlign:"left"}},o.a.createElement("button",{title:"\xdccret Bordrosu G\xf6r\xfcnt\xfcle",className:"btn-icon btn btn-info btn-sm",style:{margin:"0px 3px"},onClick:t=>this.previewBordro(e)},o.a.createElement("i",{className:"now-ui-icons ui-1_zoom-bold"})))}],t=Object(g.H)(e,"accessor",this.props.isKepOwner);return o.a.createElement("div",null,this.state.mediaModal&&o.a.createElement(E.a,{modal:this.state.mediaModal,url:this.state.url,title:"\xdccret Bordrosu",listener:this.setMediaViewer,closeModal:this.setMediaViewer}),o.a.createElement(r.a,{columns:t,content:this.state.content,loading:this.props.loading?this.props.loading:this.state.loading,total:this.state.total,page:this.state.page,manual:this.state.manual,size:this.state.size,options:["5","10","20","50","100"],fetchData:this.fetchData}),this.state.alert)}}t.a=b},1576:function(e,t,a){"use strict";a.r(t);var s=a(0),o=a.n(s),r=a(2),n=(a(93),a(13)),i=a.n(n),l=a(63),d=a.n(l),c=(a(220),a(83),a(1313)),m=a(21),p=a(1300),h=a(5),u=a(3),g=a(6),y=a.n(g);class E extends s.Component{constructor(e){super(e),this.readSmsTemplate=()=>{let e=this;Object(h.e)({url:"/signer/readBordroSmsTemplateInfo",method:"get"}).then((function(t){e.setState({smsBody:t.data})})).catch((function(e){Object(u.v)(e)}))},this.readMailTemplate=()=>{let e=this;Object(h.e)({url:"/signer/readBordroMailTemplateInfo",method:"get"}).then((function(t){t.data&&e.setState({mimeBody:t.data})})).catch((function(e){Object(u.v)(e)}))},this.state={loading:!1,completed:!1,signedDocumentCount:0,progressLength:1,selectedIdList:[],timeoutList:[]},this.notifyMimeResend=o.a.createRef(),this.resend=this.resend.bind(this),this.readMimeInfo=this.readMimeInfo.bind(this),this.checkTimeouts=this.checkTimeouts.bind(this),this.showErrorMessage=this.showErrorMessage.bind(this)}showErrorMessage(e){this.notifyMimeResend.current.notificationAlert({place:"tr",message:"Hata: "+e.errorMessage,type:"danger",autoDismiss:10})}componentDidMount(){this.props&&this.props.location&&this.props.location.session?(this.checkTimeouts(),this.readMimeInfo(),this.readSmsTemplate(),this.readMailTemplate()):this.props.history.push({pathname:"/".concat(this.props.peykName,"/bordrosessionlist")})}checkTimeouts(){let e=this,t={url:"/bordrosession/readTimeouts",method:"post",data:e.props.location.selectedIdList};e.setState({loading:!0}),Object(h.e)(t).then((function(t){t.data&&t.data.length>0?e.setState({timeoutList:t.data}):(Object(u.v)({message:"Se\xe7ili listede zaman a\u015f\u0131m\u0131na d\xfc\u015fm\xfc\u015f dok\xfcman bulunmamaktad\u0131r."}),e.props.history.push({pathname:"/".concat(e.props.peykName,"/bordroimport/")+e.props.location.session.id})),e.setState({loading:!1})})).catch((function(t){Object(u.v)(t),e.setState({loading:!1})}))}readMimeInfo(){let e=this,t={url:"/bordrosession/readMimeInfo",method:"post",data:e.props.location.session.id};e.setState({loading:!0}),Object(h.e)(t).then((function(t){e.setState({mimeTitle:t.data.mimeTitle,mimeBody:t.data.mimeBody,loading:!1}),e.props.location.isKepOwner&&e.setState({kepAccount:t.data.account})})).catch((function(t){Object(u.v)(t),e.setState({loading:!1})}))}resend(){let e=this;if(e.state.timeoutList&&e.state.timeoutList.length>0){let t={url:"/bordrosession/resend",method:"post",data:e.state.timeoutList};e.setState({disableSendBtn:!0}),Object(h.e)(t).then((function(t){y.a.success("Dok\xfcmanlar tekrar g\xf6nderim i\xe7in i\u015fleme al\u0131nd\u0131.",{position:"top-right",effect:"stackslide",timeout:2e3}),e.setState({disableSendBtn:!1}),e.props.history.push({pathname:"/".concat(e.props.peykName,"/bordroimport/")+e.props.location.session.id})})).catch((function(t){Object(u.v)(t),e.setState({disableSendBtn:!1})}))}else Object(u.v)({message:"Zaman a\u015f\u0131m\u0131na u\u011fram\u0131\u015f liste alg\u0131lanamad\u0131. L\xfctfen bu sayfadan \xe7\u0131k\u0131p yap\u0131p tekrar deneyiniz."})}renderNavButtons(){return o.a.createElement(r.Nav,{className:"topbar",style:{paddingLeft:"14px",height:"53px"}},o.a.createElement(m.a,{position:"leftSide",className:"zocial GeriDon",style:{fontSize:"x-small"},label:"Geri",title:"\xd6nceki Sayfaya Git",onClick:()=>this.props.history.push({pathname:"/".concat(this.props.peykName,"/bordroimport/")+this.props.location.session.id,selectedIdList:this.props.location.selectedIdList})}),o.a.createElement(m.a,{position:"leftSide",className:"zocial Gonder",style:{fontSize:"x-small"},label:"Tekrar G\xf6nder",title:"Zaman A\u015f\u0131m\u0131na U\u011fram\u0131\u015f Dok\xfcmanlar\u0131 Tekrar G\xf6nder",onClick:()=>{this.setState({alert:o.a.createElement(i.a,{showCancel:!0,warning:!0,confirmBtnText:"Evet",cancelBtnText:"Hay\u0131r",confirmBtnBsStyle:"danger",cancelBtnBsStyle:"default",title:"Emin misiniz?",onConfirm:()=>{this.setState({alert:null}),this.resend()},onCancel:()=>this.setState({alert:null})},"Dok\xfcmanlar tekrar g\xf6nderilecek.")})}}))}renderMimeInputs(){return o.a.createElement(r.Container,null,o.a.createElement("div",{className:"FormRenk"},this.props.location.isKepOwner&&o.a.createElement(r.Row,{sm:6},o.a.createElement(r.Col,{sm:2,style:{top:"7px"}},"Kep Hesab\u0131"),o.a.createElement(r.Col,{sm:6},o.a.createElement(r.Input,{type:"text",style:{marginTop:"2px"},value:this.state.kepAccount,disable:!0}))),o.a.createElement(r.Row,{sm:6},o.a.createElement(r.Col,{sm:2,style:{top:"5px"}},"E-posta Konu"),o.a.createElement(r.Col,{sm:6},o.a.createElement(r.Input,{type:"text",style:{marginTop:"2px"},value:this.state.mimeTitle,disable:!0}))),o.a.createElement(r.Row,{sm:6},o.a.createElement(r.Col,{sm:2,style:{top:"25px"}},"E-Posta \u0130\xe7erik"),o.a.createElement(r.Col,{sm:6},o.a.createElement(r.Input,{type:"textarea",rows:5,style:{height:"200px",border:"1px solid #E3E3E3",marginTop:"2px"},value:this.state.mimeBody,disable:!0}))),!this.props.location.isKepOwner&&o.a.createElement(r.Row,{sm:6},o.a.createElement(r.Col,{sm:2,style:{top:"25px"}},"SMS \u0130\xe7erik"),o.a.createElement(r.Col,{sm:6},o.a.createElement(r.Input,{type:"textarea",rows:5,disabled:!0,style:{height:"200px",border:"1px solid #E3E3E3",marginTop:"2px",padding:"3px 3px"},value:this.state.smsBody})))))}renderBordroList(){return o.a.createElement(c.a,{bordroSession:this.props.location.session,selectedBordroIdList:this.state.timeoutList,onComplete:e=>this.setState({timeoutList:e}),pageSize:10,history:this.props.history,peykName:this.props.peykName,processCode:p.a.RESENDMIME.code})}render(){return o.a.createElement(r.Row,{className:"baseBackground"},o.a.createElement(d.a,{ref:this.notifyMimeResend,className:"modalAlert"}),this.renderNavButtons(),this.state.alert&&o.a.createElement("div",{className:"row satirBasi"},o.a.createElement(d.a,{ref:this.notify}),this.state.alert),o.a.createElement("div",{className:"row satirBasi"},o.a.createElement(r.Col,{md:"12"},o.a.createElement(r.Card,{className:"card"},o.a.createElement(r.CardHeader,null,o.a.createElement(r.CardTitle,{tag:"h4"},"Dok\xfcman Tekrar G\xf6nder")),o.a.createElement(r.CardBody,null,this.props.location.session&&this.renderMimeInputs()),o.a.createElement(r.CardBody,null,this.state.timeoutList&&this.state.timeoutList.length>0&&this.renderBordroList())))))}}t.default=E}}]);